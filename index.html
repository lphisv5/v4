<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
  <meta name="keywords" content="YANZ, lphisv5, tools, scripts, systems, web hub, productivity tools">
  <meta name="google-site-verification" content="JBRMY2D-joTthmVgUJIx5_U7CER2SosgBqEcoRGmzp0" />
  <meta name="google-site-verification" content="ctalwY44kcnXVpIVYysi59z66XwVqQqhN-LME8GssAQ" />
  <meta name="theme-color" content="#0c1b33">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="YANZ Hub">

  <link rel="canonical" href="https://lphisv5.github.io/v4/">
  <link rel="icon" href="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg" type="image/png" alt="YANZ favicon" />
  <link rel="apple-touch-icon" href="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg">
  <link rel="manifest" href="manifest.json">
  <meta name="author" content="YANZ" />
  <title>YANZ - Secure Access</title>
  <meta name="description" content="YANZ Winter Edition - Secure tools collection with advanced authentication." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg" />
  <meta property="og:url" content="https://lphisv5.github.io/v4" />
  <meta property="og:title" content="YANZ Hub - Winter Edition" />
  <meta property="og:description" content="YANZ Winter Edition - Tools collection with a beautiful winter interface." />
  <meta property="og:image" content="https://i.postimg.cc/hv65wD1d/328c881f1929b778adcc7d9c1c75adcd.gif" alt="YANZ preview image" />
  <meta name="twitter:card" content="summary_large_image" />
  
  <!-- Preload critical resources -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" as="style" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" />
  
  <!-- EmailJS for email verification -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  
  <style>
    /* ===== CSS VARIABLES ===== */
    :root {
      /* Winter Colors */
      --primary-bg: #0c1b33;
      --secondary-bg: #1e3a5f;
      --accent-color: #4fc3f7;
      --accent-secondary: #29b6f6;
      --winter-blue: #4fc3f7;
      --winter-light-blue: #b3e5fc;
      --winter-white: #e1f5fe;
      --winter-silver: #eceff1;
      --text-primary: #f8fafc;
      --text-secondary: #e2e8f0;
      --text-muted: #a0aec0;
      --success-color: #81c784;
      --error-color: #e57373;
      --warning-color: #ffb74d;
      --card-bg: rgba(30, 58, 95, 0.8);
      --card-hover-bg: rgba(41, 98, 158, 0.9);
      --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
      --card-hover-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --border-radius: 12px;
      --border-radius-lg: 16px;
      --border-radius-xl: 24px;
      
      /* Spacing */
      --space-xs: 0.5rem;
      --space-sm: 1rem;
      --space-md: 1.5rem;
      --space-lg: 2rem;
      --space-xl: 3rem;
      
      /* Typography */
      --font-size-xs: 0.75rem;
      --font-size-sm: 0.875rem;
      --font-size-base: 1rem;
      --font-size-lg: 1.125rem;
      --font-size-xl: 1.25rem;
      --font-size-2xl: 1.5rem;
      --font-size-3xl: 1.875rem;
      --font-size-4xl: 2.25rem;
    }

    /* ===== WINTER ANIMATIONS ===== */
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    @keyframes winter-glow {
      0%, 100% { box-shadow: 0 0 5px var(--winter-blue), 0 0 10px var(--winter-blue); }
      50% { box-shadow: 0 0 15px var(--winter-blue), 0 0 30px var(--winter-blue); }
    }

    @keyframes winter-text {
      0%, 100% { text-shadow: 0 0 5px var(--winter-blue), 0 0 10px var(--winter-blue); }
      50% { text-shadow: 0 0 10px var(--winter-blue), 0 0 20px var(--winter-blue), 0 0 30px var(--winter-blue); }
    }

    @keyframes snow-fall {
      0% { transform: translateY(-100px) translateX(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) translateX(20px) rotate(360deg); opacity: 0; }
    }

    @keyframes snowflake-float {
      0%, 100% { transform: translateY(0) translateX(0); opacity: 0.7; }
      25% { transform: translateY(-10px) translateX(10px); opacity: 0.9; }
      50% { transform: translateY(-5px) translateX(-10px); opacity: 0.8; }
      75% { transform: translateY(-8px) translateX(5px); opacity: 0.9; }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* ===== BASE STYLES ===== */
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      font-size: 16px;
    }

    body {
      font-family: 'Inter', sans-serif;
      color: var(--text-primary);
      background: var(--primary-bg);
      line-height: 1.6;
      overflow-x: hidden;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: var(--transition);
      position: relative;
    }

    /* Winter Background Elements */
    .winter-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
      background: linear-gradient(to bottom, var(--primary-bg), var(--secondary-bg), var(--primary-bg));
    }

    .snowflake {
      position: absolute;
      color: var(--winter-white);
      font-size: 20px;
      animation: snow-fall 10s linear infinite;
      z-index: -1;
      opacity: 0.7;
      user-select: none;
    }

    .snowflake:nth-child(2n) {
      animation-duration: 12s;
    }

    .snowflake:nth-child(3n) {
      animation-duration: 8s;
    }

    .snowflake:nth-child(4n) {
      animation-duration: 14s;
    }

    .ice-crystal {
      position: absolute;
      font-size: 30px;
      color: var(--winter-light-blue);
      animation: snowflake-float 8s ease-in-out infinite;
      z-index: -1;
      opacity: 0.5;
    }

    /* ===== SECURITY BADGES ===== */
    .security-badges {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
      display: flex;
      gap: 5px;
    }

    .security-badge {
      background: rgba(30, 58, 95, 0.8);
      backdrop-filter: blur(10px);
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 11px;
      color: var(--winter-blue);
      border: 1px solid rgba(79, 195, 247, 0.3);
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .security-badge i {
      font-size: 10px;
    }

    /* ===== LOADER ===== */
    .loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--primary-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }

    .loader.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .loader-content {
      text-align: center;
    }

    .loader-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(79, 195, 247, 0.3);
      border-top: 4px solid var(--winter-blue);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto var(--space-md);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loader-text {
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
    }

    /* ===== AUTHENTICATION CONTAINER ===== */
    .auth-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--space-xl) var(--space-md);
    }

    .auth-card {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border-radius: var(--border-radius-xl);
      padding: var(--space-xl);
      width: 100%;
      max-width: 500px;
      border: 1px solid rgba(79, 195, 247, 0.3);
      box-shadow: var(--card-hover-shadow);
      position: relative;
      overflow: hidden;
    }

    .auth-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--winter-blue), var(--winter-light-blue), var(--winter-white));
    }

    .auth-header {
      text-align: center;
      margin-bottom: var(--space-xl);
    }

    .auth-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-sm);
      margin-bottom: var(--space-lg);
      text-decoration: none;
    }

    .auth-logo img {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 2px solid var(--winter-blue);
      animation: winter-glow 3s infinite;
    }

    .auth-logo-text {
      font-size: var(--font-size-2xl);
      font-weight: 700;
      background: linear-gradient(135deg, var(--winter-blue), var(--winter-light-blue));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: winter-text 3s infinite;
    }

    .auth-title {
      font-size: var(--font-size-2xl);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-xs);
    }

    .auth-subtitle {
      color: var(--text-secondary);
      font-size: var(--font-size-base);
    }

    /* ===== FORM STYLES ===== */
    .auth-form {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }

    .form-group {
      position: relative;
    }

    .form-label {
      display: block;
      margin-bottom: var(--space-xs);
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
      font-weight: 500;
    }

    .form-label.required::after {
      content: ' *';
      color: var(--error-color);
    }

    .form-input {
      width: 100%;
      padding: 0.875rem 1rem;
      background: rgba(30, 58, 95, 0.5);
      border: 1px solid rgba(79, 195, 247, 0.3);
      border-radius: var(--border-radius);
      color: var(--text-primary);
      font-family: 'Inter', sans-serif;
      transition: var(--transition);
      font-size: var(--font-size-base);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--winter-blue);
      box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.3);
      animation: winter-glow 2s infinite;
    }

    .form-input.error {
      border-color: var(--error-color);
    }

    .form-input.success {
      border-color: var(--success-color);
    }

    .input-with-icon {
      position: relative;
    }

    .input-icon {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
      cursor: pointer;
    }

    .error-message {
      color: var(--error-color);
      font-size: var(--font-size-xs);
      margin-top: 0.25rem;
      display: none;
    }

    .error-message.show {
      display: block;
    }

    .password-strength {
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 2px;
      margin-top: 0.25rem;
      overflow: hidden;
    }

    .password-strength-bar {
      height: 100%;
      width: 0%;
      transition: var(--transition);
      border-radius: 2px;
    }

    .strength-weak { background: var(--error-color); }
    .strength-fair { background: var(--warning-color); }
    .strength-good { background: #ffd166; }
    .strength-strong { background: var(--success-color); }

    .password-requirements {
      margin-top: 0.5rem;
      font-size: var(--font-size-xs);
      color: var(--text-muted);
    }

    .requirement {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      margin-bottom: 0.125rem;
    }

    .requirement i {
      font-size: 10px;
    }

    .requirement.valid {
      color: var(--success-color);
    }

    .requirement.invalid {
      color: var(--text-muted);
    }

    /* ===== CAPTCHA ===== */
    .captcha-container {
      background: rgba(30, 58, 95, 0.5);
      border-radius: var(--border-radius);
      padding: var(--space-sm);
      border: 1px solid rgba(79, 195, 247, 0.3);
    }

    .captcha-text {
      font-family: monospace;
      font-size: 1.5rem;
      letter-spacing: 5px;
      text-align: center;
      background: linear-gradient(90deg, var(--winter-blue), var(--winter-light-blue));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      padding: 0.5rem;
      margin-bottom: var(--space-sm);
      user-select: none;
    }

    .captcha-input {
      width: 100%;
    }

    .captcha-refresh {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--winter-blue);
      cursor: pointer;
      transition: var(--transition);
    }

    .captcha-refresh:hover {
      color: var(--winter-light-blue);
    }

    /* ===== TERMS ===== */
    .terms-container {
      display: flex;
      align-items: flex-start;
      gap: var(--space-xs);
      margin: var(--space-md) 0;
    }

    .terms-checkbox {
      margin-top: 0.25rem;
    }

    .terms-label {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      line-height: 1.4;
    }

    .terms-link {
      color: var(--winter-blue);
      text-decoration: none;
      transition: var(--transition);
    }

    .terms-link:hover {
      text-decoration: underline;
    }

    /* ===== BUTTONS ===== */
    .auth-buttons {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
      margin-top: var(--space-lg);
    }

    .btn {
      padding: 0.875rem 1.5rem;
      border-radius: var(--border-radius);
      border: none;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      font-size: var(--font-size-base);
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--winter-blue), var(--winter-light-blue));
      color: #0c1b33;
      box-shadow: 0 4px 12px rgba(79, 195, 247, 0.4);
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(79, 195, 247, 0.6);
      animation: winter-glow 2s infinite;
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid rgba(79, 195, 247, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(79, 195, 247, 0.1);
      color: var(--winter-blue);
      border-color: var(--winter-blue);
    }

    /* ===== AUTH LINKS ===== */
    .auth-links {
      text-align: center;
      margin-top: var(--space-lg);
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
    }

    .auth-link {
      color: var(--winter-blue);
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
    }

    .auth-link:hover {
      text-decoration: underline;
    }

    /* ===== OTP VERIFICATION ===== */
    .otp-container {
      text-align: center;
    }

    .otp-inputs {
      display: flex;
      gap: var(--space-sm);
      justify-content: center;
      margin: var(--space-lg) 0;
    }

    .otp-input {
      width: 50px;
      height: 60px;
      text-align: center;
      font-size: var(--font-size-2xl);
      background: rgba(30, 58, 95, 0.5);
      border: 1px solid rgba(79, 195, 247, 0.3);
      border-radius: var(--border-radius);
      color: var(--text-primary);
      transition: var(--transition);
    }

    .otp-input:focus {
      outline: none;
      border-color: var(--winter-blue);
      box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.3);
    }

    .otp-timer {
      color: var(--text-muted);
      font-size: var(--font-size-sm);
      margin-top: var(--space-sm);
    }

    .otp-resend {
      background: none;
      border: none;
      color: var(--winter-blue);
      cursor: pointer;
      font-size: var(--font-size-sm);
      transition: var(--transition);
    }

    .otp-resend:hover:not(:disabled) {
      text-decoration: underline;
    }

    .otp-resend:disabled {
      color: var(--text-muted);
      cursor: not-allowed;
    }

    /* ===== SECURITY INFO ===== */
    .security-info {
      background: rgba(30, 58, 95, 0.3);
      border-radius: var(--border-radius);
      padding: var(--space-md);
      margin-top: var(--space-lg);
      border: 1px solid rgba(79, 195, 247, 0.2);
    }

    .security-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-primary);
      font-size: var(--font-size-sm);
      margin-bottom: var(--space-xs);
    }

    .security-list {
      list-style: none;
      font-size: var(--font-size-xs);
      color: var(--text-secondary);
    }

    .security-list li {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.25rem;
    }

    .security-list i {
      color: var(--winter-blue);
      font-size: 10px;
    }

    /* ===== MODALS ===== */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      padding: var(--space-md);
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: var(--secondary-bg);
      border-radius: var(--border-radius-lg);
      padding: var(--space-xl);
      max-width: 500px;
      width: 100%;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(79, 195, 247, 0.3);
      animation: modalSlideIn 0.3s ease-out;
      position: relative;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-header {
      text-align: center;
      margin-bottom: var(--space-lg);
    }

    .modal-title {
      font-size: var(--font-size-xl);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-xs);
    }

    .modal-subtitle {
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
    }

    /* ===== NOTIFICATION ===== */
    .notification {
      position: fixed;
      bottom: var(--space-lg);
      right: var(--space-lg);
      background: var(--secondary-bg);
      color: var(--text-primary);
      padding: var(--space-md);
      border-radius: var(--border-radius);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      z-index: 1001;
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      transform: translateY(100px);
      opacity: 0;
      transition: var(--transition);
      max-width: 400px;
      border-left: 4px solid var(--winter-blue);
      animation: winter-glow 2s infinite;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    .notification-close {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      margin-left: auto;
      transition: var(--transition);
    }

    .notification-close:hover {
      color: var(--text-primary);
    }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 768px) {
      .auth-card {
        padding: var(--space-lg);
      }
      
      .otp-input {
        width: 45px;
        height: 55px;
        font-size: var(--font-size-xl);
      }
      
      .security-badges {
        display: none;
      }
    }

    @media (max-width: 480px) {
      .auth-card {
        padding: var(--space-md);
      }
      
      .otp-inputs {
        gap: var(--space-xs);
      }
      
      .otp-input {
        width: 40px;
        height: 50px;
        font-size: var(--font-size-lg);
      }
    }
  </style>
</head>
<body>
  <!-- Winter Background Elements -->
  <div class="winter-bg" id="winter-bg"></div>

  <!-- Security Badges -->
  <div class="security-badges">
    <div class="security-badge">
      <i class="fas fa-shield-alt"></i> SSL Secured
    </div>
    <div class="security-badge">
      <i class="fas fa-lock"></i> AES-256
    </div>
  </div>

  <!-- Loader -->
  <div class="loader" id="loader">
    <div class="loader-content">
      <div class="loader-spinner"></div>
      <div class="loader-text">Initializing Security Systems...</div>
    </div>
  </div>

  <!-- Authentication Container -->
  <div class="auth-container" id="auth-container">
    <!-- Login Form -->
    <div class="auth-card" id="login-card">
      <div class="auth-header">
        <a href="#" class="auth-logo">
          <img src="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg" alt="YANZ Logo">
          <span class="auth-logo-text">YANZ</span>
        </a>
        <h1 class="auth-title">Welcome Back</h1>
        <p class="auth-subtitle">Sign in to access your tools dashboard</p>
      </div>

      <form class="auth-form" id="login-form">
        <div class="form-group">
          <label for="login-email" class="form-label required">Email Address</label>
          <input type="email" id="login-email" class="form-input" placeholder="Enter your email" required>
          <div class="error-message" id="login-email-error"></div>
        </div>

        <div class="form-group">
          <label for="login-password" class="form-label required">Password</label>
          <div class="input-with-icon">
            <input type="password" id="login-password" class="form-input" placeholder="Enter your password" required>
            <i class="fas fa-eye input-icon" id="toggle-login-password"></i>
          </div>
          <div class="error-message" id="login-password-error"></div>
        </div>

        <div class="form-group">
          <div class="captcha-container">
            <div class="captcha-text" id="captcha-text"></div>
            <div class="input-with-icon">
              <input type="text" id="captcha-input" class="form-input captcha-input" placeholder="Enter the code above" required>
              <button type="button" class="captcha-refresh" id="refresh-captcha">
                <i class="fas fa-redo"></i>
              </button>
            </div>
          </div>
          <div class="error-message" id="captcha-error"></div>
        </div>

        <div class="auth-buttons">
          <button type="submit" class="btn btn-primary" id="login-submit">
            <i class="fas fa-sign-in-alt"></i> Sign In
          </button>
          <button type="button" class="btn btn-secondary" id="goto-register">
            <i class="fas fa-user-plus"></i> Create Account
          </button>
        </div>
      </form>

      <div class="auth-links">
        <a href="#" class="auth-link" id="forgot-password">Forgot Password?</a>
      </div>

      <div class="security-info">
        <div class="security-title">
          <i class="fas fa-shield-alt"></i>
          <span>Security Information</span>
        </div>
        <ul class="security-list">
          <li><i class="fas fa-check-circle"></i> All connections are encrypted with AES-256</li>
          <li><i class="fas fa-check-circle"></i> Rate limiting protects against brute force attacks</li>
          <li><i class="fas fa-check-circle"></i> Suspicious activity monitoring enabled</li>
        </ul>
      </div>
    </div>

    <!-- Registration Form -->
    <div class="auth-card" id="register-card" style="display: none;">
      <div class="auth-header">
        <a href="#" class="auth-logo">
          <img src="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg" alt="YANZ Logo">
          <span class="auth-logo-text">YANZ</span>
        </a>
        <h1 class="auth-title">Create Account</h1>
        <p class="auth-subtitle">Join YANZ for access to premium tools</p>
      </div>

      <form class="auth-form" id="register-form">
        <div class="form-group">
          <label for="register-username" class="form-label required">Username</label>
          <input type="text" id="register-username" class="form-input" placeholder="Choose a username" required>
          <div class="error-message" id="username-error"></div>
        </div>

        <div class="form-group">
          <label for="register-email" class="form-label required">Email Address</label>
          <input type="email" id="register-email" class="form-input" placeholder="Enter your email" required>
          <div class="error-message" id="email-error"></div>
        </div>

        <div class="form-group">
          <label for="register-password" class="form-label required">Password</label>
          <div class="input-with-icon">
            <input type="password" id="register-password" class="form-input" placeholder="Create a strong password" required>
            <i class="fas fa-eye input-icon" id="toggle-register-password"></i>
          </div>
          <div class="password-strength">
            <div class="password-strength-bar" id="password-strength-bar"></div>
          </div>
          <div class="password-requirements" id="password-requirements">
            <div class="requirement invalid" id="req-length">
              <i class="fas fa-circle"></i> At least 8 characters
            </div>
            <div class="requirement invalid" id="req-uppercase">
              <i class="fas fa-circle"></i> One uppercase letter
            </div>
            <div class="requirement invalid" id="req-lowercase">
              <i class="fas fa-circle"></i> One lowercase letter
            </div>
            <div class="requirement invalid" id="req-number">
              <i class="fas fa-circle"></i> One number
            </div>
            <div class="requirement invalid" id="req-special">
              <i class="fas fa-circle"></i> One special character
            </div>
          </div>
          <div class="error-message" id="password-error"></div>
        </div>

        <div class="form-group">
          <label for="confirm-password" class="form-label required">Confirm Password</label>
          <div class="input-with-icon">
            <input type="password" id="confirm-password" class="form-input" placeholder="Confirm your password" required>
            <i class="fas fa-eye input-icon" id="toggle-confirm-password"></i>
          </div>
          <div class="error-message" id="confirm-password-error"></div>
        </div>

        <div class="terms-container">
          <input type="checkbox" id="terms-agree" class="terms-checkbox" required>
          <label for="terms-agree" class="terms-label">
            I agree to the <a href="#" class="terms-link">Terms of Service</a> and <a href="#" class="terms-link">Privacy Policy</a>. 
            I understand that my data will be processed in accordance with these terms.
          </label>
        </div>
        <div class="error-message" id="terms-error"></div>

        <div class="auth-buttons">
          <button type="submit" class="btn btn-primary" id="register-submit">
            <i class="fas fa-user-plus"></i> Create Account
          </button>
          <button type="button" class="btn btn-secondary" id="goto-login">
            <i class="fas fa-sign-in-alt"></i> Back to Login
          </button>
        </div>
      </form>

      <div class="security-info">
        <div class="security-title">
          <i class="fas fa-user-shield"></i>
          <span>Account Security</span>
        </div>
        <ul class="security-list">
          <li><i class="fas fa-check-circle"></i> Email verification required</li>
          <li><i class="fas fa-check-circle"></i> Strong password enforcement</li>
          <li><i class="fas fa-check-circle"></i> Account activity monitoring</li>
        </ul>
      </div>
    </div>

    <!-- OTP Verification -->
    <div class="auth-card" id="otp-card" style="display: none;">
      <div class="auth-header">
        <a href="#" class="auth-logo">
          <img src="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg" alt="YANZ Logo">
          <span class="auth-logo-text">YANZ</span>
        </a>
        <h1 class="auth-title">Verify Email</h1>
        <p class="auth-subtitle">Enter the 6-digit code sent to your email</p>
      </div>

      <div class="otp-container">
        <div class="otp-inputs" id="otp-inputs">
          <input type="text" class="otp-input" maxlength="1" data-index="0">
          <input type="text" class="otp-input" maxlength="1" data-index="1">
          <input type="text" class="otp-input" maxlength="1" data-index="2">
          <input type="text" class="otp-input" maxlength="1" data-index="3">
          <input type="text" class="otp-input" maxlength="1" data-index="4">
          <input type="text" class="otp-input" maxlength="1" data-index="5">
        </div>

        <div class="error-message" id="otp-error"></div>

        <div class="otp-timer">
          Code expires in: <span id="otp-timer">05:00</span>
        </div>

        <div class="auth-buttons">
          <button type="button" class="btn btn-primary" id="verify-otp">
            <i class="fas fa-check-circle"></i> Verify Account
          </button>
          <button type="button" class="btn btn-secondary" id="resend-otp" disabled>
            <i class="fas fa-redo"></i> Resend Code (<span id="resend-timer">60</span>s)
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Terms Modal -->
  <div class="modal-overlay" id="terms-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Terms of Service</h3>
        <p class="modal-subtitle">Last Updated: 2025</p>
      </div>
      <div class="modal-body">
        <div style="max-height: 400px; overflow-y: auto; padding-right: 10px;">
          <h4>1. Acceptance of Terms</h4>
          <p>By accessing and using YANZ services, you agree to be bound by these Terms of Service.</p>
          
          <h4>2. User Accounts</h4>
          <p>You must provide accurate and complete information when creating an account. You are responsible for maintaining the security of your account.</p>
          
          <h4>3. Acceptable Use</h4>
          <p>You agree not to use the service for any illegal or unauthorized purpose. You must not violate any laws in your jurisdiction.</p>
          
          <h4>4. Privacy Policy</h4>
          <p>Your privacy is important to us. Please review our Privacy Policy to understand how we collect and use information.</p>
          
          <h4>5. Service Modifications</h4>
          <p>We reserve the right to modify or discontinue the service at any time without notice.</p>
          
          <h4>6. Limitation of Liability</h4>
          <p>YANZ shall not be liable for any indirect, incidental, special, consequential or punitive damages.</p>
        </div>
        <div class="form-actions" style="margin-top: 20px;">
          <button type="button" class="btn btn-primary" id="close-terms">I Understand</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i>
    <span id="notification-message">This is a notification</span>
    <button class="notification-close" id="notification-close">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { 
      getDatabase, 
      ref, 
      set, 
      get, 
      child, 
      update, 
      remove, 
      onValue, 
      serverTimestamp,
      query,
      orderByChild,
      equalTo,
      runTransaction 
    } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyA_sh9fh7h1gGOurALEWJAq3Y-o7vSeaCM",
      authDomain: "yanzz-6e06c.firebaseapp.com",
      databaseURL: "https://yanzz-6e06c-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "yanzz-6e06c",
      storageBucket: "yanzz-6e06c.firebasestorage.app",
      messagingSenderId: "951083749698",
      appId: "1:951083749698:web:3e279cd0dc9a9be39bf8db",
      measurementId: "G-YV2G95Z9HE"
    };

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // Initialize EmailJS ด้วยรหัส service_pt8m9lp ของคุณ
    (function() {
      emailjs.init("service_pt8m9lp");
    })();

    class SecuritySystem {
      constructor() {
        this.loginAttempts = {};
        this.MAX_ATTEMPTS = 5;
        this.LOCKOUT_TIME = 15 * 60 * 1000;
        this.userActivity = {};
      }

      trackLoginAttempt(email) {
        const now = Date.now();
        if (!this.loginAttempts[email]) {
          this.loginAttempts[email] = {
            attempts: 1,
            lastAttempt: now,
            locked: false,
            lockUntil: 0
          };
        } else {
          const userAttempts = this.loginAttempts[email];
          const timeSinceLastAttempt = now - userAttempts.lastAttempt;
          
          // Reset attempts if more than 5 minutes since last attempt
          if (timeSinceLastAttempt > 5 * 60 * 1000) {
            userAttempts.attempts = 1;
          } else {
            userAttempts.attempts++;
          }
          
          userAttempts.lastAttempt = now;
          
          // Lock account if too many attempts
          if (userAttempts.attempts >= this.MAX_ATTEMPTS) {
            userAttempts.locked = true;
            userAttempts.lockUntil = now + this.LOCKOUT_TIME;
            this.logSecurityEvent(email, 'ACCOUNT_LOCKED', 'Too many failed login attempts');
          }
        }
        
        return this.loginAttempts[email];
      }

      isAccountLocked(email) {
        const userAttempts = this.loginAttempts[email];
        if (!userAttempts) return false;
        
        if (userAttempts.locked && Date.now() < userAttempts.lockUntil) {
          return true;
        } else if (userAttempts.locked && Date.now() >= userAttempts.lockUntil) {
          // Unlock account after lockout period
          userAttempts.locked = false;
          userAttempts.attempts = 0;
          return false;
        }
        
        return false;
      }

      resetLoginAttempts(email) {
        if (this.loginAttempts[email]) {
          this.loginAttempts[email] = {
            attempts: 0,
            lastAttempt: Date.now(),
            locked: false,
            lockUntil: 0
          };
        }
      }

      logSecurityEvent(userId, eventType, details) {
        const eventRef = ref(database, `securityLogs/${Date.now()}`);
        set(eventRef, {
          userId,
          eventType,
          details,
          timestamp: serverTimestamp(),
          userAgent: navigator.userAgent,
          ip: 'detected' // ใน production ควรดึงจาก server-side
        });
      }

      validatePassword(password) {
        const requirements = {
          length: password.length >= 8,
          uppercase: /[A-Z]/.test(password),
          lowercase: /[a-z]/.test(password),
          number: /\d/.test(password),
          special: /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)
        };
        
        const strength = Object.values(requirements).filter(Boolean).length;
        return { requirements, strength };
      }

      generateOTP() {
        return Math.floor(100000 + Math.random() * 900000).toString();
      }

      generateCaptcha() {
        const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789';
        let captcha = '';
        for (let i = 0; i < 6; i++) {
          captcha += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return captcha;
      }

      validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email) && email.length <= 254;
      }

      validateUsername(username) {
        return /^[a-zA-Z0-9_]{3,20}$/.test(username);
      }
    }

    class AuthenticationSystem {
      constructor() {
        this.security = new SecuritySystem();
        this.currentCaptcha = '';
        this.currentOTP = '';
        this.currentEmail = '';
        this.otpTimer = null;
        this.resendTimer = null;
        this.userSession = null;
      }

      async checkEmailExists(email) {
        try {
          const usersRef = ref(database, 'users');
          const snapshot = await get(query(usersRef, orderByChild('email'), equalTo(email)));
          return snapshot.exists();
        } catch (error) {
          console.error('Error checking email:', error);
          return false;
        }
      }

      async checkUsernameExists(username) {
        try {
          const usersRef = ref(database, 'users');
          const snapshot = await get(query(usersRef, orderByChild('username'), equalTo(username)));
          return snapshot.exists();
        } catch (error) {
          console.error('Error checking username:', error);
          return false;
        }
      }

      async registerUser(userData) {
        try {
          // Check if email already exists
          const emailExists = await this.checkEmailExists(userData.email);
          if (emailExists) {
            throw new Error('Email already registered');
          }

          // Check if username already exists
          const usernameExists = await this.checkUsernameExists(userData.username);
          if (usernameExists) {
            throw new Error('Username already taken');
          }

          // Create user record
          const userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
          const userRef = ref(database, `users/${userId}`);
          
          const userRecord = {
            userId,
            username: userData.username,
            email: userData.email.toLowerCase(),
            password: this.hashPassword(userData.password),
            createdAt: serverTimestamp(),
            verified: false,
            lastLogin: null,
            loginCount: 0,
            tier: 'free',
            status: 'active',
            security: {
              lastPasswordChange: serverTimestamp(),
              failedAttempts: 0,
              lastFailedAttempt: null
            }
          };

          await set(userRef, userRecord);
          
          // Log registration
          this.security.logSecurityEvent(userId, 'REGISTRATION', 'New user registered');
          
          return { success: true, userId, email: userData.email };
        } catch (error) {
          console.error('Registration error:', error);
          throw error;
        }
      }

      async loginUser(email, password) {
        try {
          // Check if account is locked
          if (this.security.isAccountLocked(email)) {
            const userAttempts = this.security.loginAttempts[email];
            const timeLeft = Math.ceil((userAttempts.lockUntil - Date.now()) / 60000);
            throw new Error(`Account locked. Try again in ${timeLeft} minutes`);
          }

          // Find user by email
          const usersRef = ref(database, 'users');
          const snapshot = await get(query(usersRef, orderByChild('email'), equalTo(email.toLowerCase())));
          
          if (!snapshot.exists()) {
            this.security.trackLoginAttempt(email);
            throw new Error('Invalid email or password');
          }

          let userData = null;
          let userId = null;
          
          snapshot.forEach((childSnapshot) => {
            userData = childSnapshot.val();
            userId = childSnapshot.key;
          });

          // Verify password
          const hashedPassword = this.hashPassword(password);
          if (userData.password !== hashedPassword) {
            this.security.trackLoginAttempt(email);
            
            // Update failed attempts in database
            const userRef = ref(database, `users/${userId}/security`);
            await update(userRef, {
              failedAttempts: (userData.security?.failedAttempts || 0) + 1,
              lastFailedAttempt: serverTimestamp()
            });
            
            throw new Error('Invalid email or password');
          }

          // Check if account is verified
          if (!userData.verified) {
            throw new Error('Please verify your email address first');
          }

          // Reset login attempts
          this.security.resetLoginAttempts(email);
          
          // Update user record
          const userRef = ref(database, `users/${userId}`);
          await update(userRef, {
            lastLogin: serverTimestamp(),
            loginCount: (userData.loginCount || 0) + 1,
            'security.failedAttempts': 0,
            'security.lastFailedAttempt': null
          });

          // Create session
          const sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
          const sessionRef = ref(database, `sessions/${sessionId}`);
          
          await set(sessionRef, {
            userId,
            sessionId,
            createdAt: serverTimestamp(),
            lastActivity: serverTimestamp(),
            userAgent: navigator.userAgent,
            ip: 'detected'
          });

          // Log successful login
          this.security.logSecurityEvent(userId, 'LOGIN_SUCCESS', 'User logged in successfully');

          return { 
            success: true, 
            userId, 
            username: userData.username,
            email: userData.email,
            sessionId,
            tier: userData.tier 
          };

        } catch (error) {
          console.error('Login error:', error);
          throw error;
        }
      }

      hashPassword(password) {
        let hash = 0;
        for (let i = 0; i < password.length; i++) {
          const char = password.charCodeAt(i);
          hash = ((hash << 5) - hash) + char;
          hash = hash & hash;
        }
        return hash.toString(36);
      }

      async sendVerificationEmail(email, otp) {
        try {
          const templateParams = {
            to_email: email,
            to_name: email.split('@')[0],
            otp_code: otp,
            app_name: 'YANZ',
            current_year: new Date().getFullYear()
          };

          const response = await emailjs.send(
            'service_pt8m9lp',
            'template_5fwmpvu',
            templateParams
          );

          console.log('Email sent successfully:', response);
          
          // เก็บ OTP ใน Firebase ด้วย
          const otpRef = ref(database, `otps/${email.replace(/[^a-zA-Z0-9]/g, '_')}`);
          await set(otpRef, {
            otp,
            email,
            createdAt: serverTimestamp(),
            expiresAt: Date.now() + 5 * 60 * 1000
          });

          return true;
        } catch (error) {
          console.error('Error sending verification email:', error);
          // ถ้าส่งอีเมลไม่สำเร็จ ให้ใช้ fallback เก็บใน Firebase และแสดงใน console
          const otpRef = ref(database, `otps/${email.replace(/[^a-zA-Z0-9]/g, '_')}`);
          await set(otpRef, {
            otp,
            email,
            createdAt: serverTimestamp(),
            expiresAt: Date.now() + 5 * 60 * 1000
          });
          
          console.log(`Fallback OTP for ${email}: ${otp}`);
          throw new Error('OTP has been generated but email sending failed. Check console for OTP.');
        }
      }

      async verifyOTP(email, otp) {
        try {
          const otpRef = ref(database, `otps/${email.replace(/[^a-zA-Z0-9]/g, '_')}`);
          const snapshot = await get(otpRef);
          
          if (!snapshot.exists()) {
            throw new Error('OTP expired or invalid');
          }

          const otpData = snapshot.val();
          
          // Check if OTP is expired
          if (Date.now() > otpData.expiresAt) {
            await remove(otpRef);
            throw new Error('OTP expired');
          }

          // Verify OTP
          if (otpData.otp !== otp) {
            throw new Error('Invalid OTP');
          }

          // Mark user as verified
          const usersRef = ref(database, 'users');
          const userSnapshot = await get(query(usersRef, orderByChild('email'), equalTo(email.toLowerCase())));
          
          if (userSnapshot.exists()) {
            let userId = null;
            userSnapshot.forEach((childSnapshot) => {
              userId = childSnapshot.key;
            });

            if (userId) {
              const userRef = ref(database, `users/${userId}`);
              await update(userRef, { verified: true });
              
              // Remove used OTP
              await remove(otpRef);
              
              this.security.logSecurityEvent(userId, 'EMAIL_VERIFIED', 'User verified email address');
              
              return { success: true, userId };
            }
          }

          throw new Error('User not found');
        } catch (error) {
          console.error('OTP verification error:', error);
          throw error;
        }
      }

      startOTPTimer(duration, onUpdate, onComplete) {
        let timeLeft = duration;
        
        this.otpTimer = setInterval(() => {
          timeLeft--;
          
          if (onUpdate) {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            onUpdate(`${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`);
          }
          
          if (timeLeft <= 0) {
            clearInterval(this.otpTimer);
            if (onComplete) onComplete();
          }
        }, 1000);
      }

      startResendTimer(duration, onUpdate, onComplete) {
        let timeLeft = duration;
        
        this.resendTimer = setInterval(() => {
          timeLeft--;
          
          if (onUpdate) {
            onUpdate(timeLeft);
          }
          
          if (timeLeft <= 0) {
            clearInterval(this.resendTimer);
            if (onComplete) onComplete();
          }
        }, 1000);
      }

      cleanup() {
        if (this.otpTimer) clearInterval(this.otpTimer);
        if (this.resendTimer) clearInterval(this.resendTimer);
      }
    }

    // Initialize authentication system
    window.authSystem = new AuthenticationSystem();
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize
      createWinterElements();
      initializeCaptcha();
      setupEventListeners();
      
      // Check if user is already logged in
      checkExistingSession();
      
      // Hide loader after 1.5 seconds
      setTimeout(() => {
        const loader = document.getElementById('loader');
        if (loader) {
          loader.classList.add('hidden');
        }
      }, 1500);
    });

    // DOM Elements
    const elements = {
      // Cards
      loginCard: document.getElementById('login-card'),
      registerCard: document.getElementById('register-card'),
      otpCard: document.getElementById('otp-card'),
      authContainer: document.getElementById('auth-container'),
      
      // Forms
      loginForm: document.getElementById('login-form'),
      registerForm: document.getElementById('register-form'),
      
      // Login inputs
      loginEmail: document.getElementById('login-email'),
      loginPassword: document.getElementById('login-password'),
      captchaText: document.getElementById('captcha-text'),
      captchaInput: document.getElementById('captcha-input'),
      
      // Register inputs
      registerUsername: document.getElementById('register-username'),
      registerEmail: document.getElementById('register-email'),
      registerPassword: document.getElementById('register-password'),
      confirmPassword: document.getElementById('confirm-password'),
      termsAgree: document.getElementById('terms-agree'),
      
      // OTP inputs
      otpInputs: document.querySelectorAll('.otp-input'),
      
      // Buttons
      gotoRegister: document.getElementById('goto-register'),
      gotoLogin: document.getElementById('goto-login'),
      loginSubmit: document.getElementById('login-submit'),
      registerSubmit: document.getElementById('register-submit'),
      verifyOtp: document.getElementById('verify-otp'),
      resendOtp: document.getElementById('resend-otp'),
      refreshCaptcha: document.getElementById('refresh-captcha'),
      toggleLoginPassword: document.getElementById('toggle-login-password'),
      toggleRegisterPassword: document.getElementById('toggle-register-password'),
      toggleConfirmPassword: document.getElementById('toggle-confirm-password'),
      forgotPassword: document.getElementById('forgot-password'),
      
      // Error messages
      errorMessages: {
        loginEmail: document.getElementById('login-email-error'),
        loginPassword: document.getElementById('login-password-error'),
        captcha: document.getElementById('captcha-error'),
        username: document.getElementById('username-error'),
        email: document.getElementById('email-error'),
        password: document.getElementById('password-error'),
        confirmPassword: document.getElementById('confirm-password-error'),
        terms: document.getElementById('terms-error'),
        otp: document.getElementById('otp-error')
      },
      
      // Other
      passwordStrengthBar: document.getElementById('password-strength-bar'),
      passwordRequirements: document.getElementById('password-requirements'),
      otpTimer: document.getElementById('otp-timer'),
      resendTimer: document.getElementById('resend-timer'),
      notification: document.getElementById('notification'),
      notificationMessage: document.getElementById('notification-message'),
      notificationClose: document.getElementById('notification-close'),
      termsModal: document.getElementById('terms-modal'),
      closeTerms: document.getElementById('close-terms'),
      loader: document.getElementById('loader')
    };

    let currentCaptcha = '';
    let currentOTP = '';
    let currentEmail = '';
    let isResendEnabled = false;

    function createWinterElements() {
      const winterBg = document.getElementById('winter-bg');
      if (!winterBg) return;
      
      const snowflakeSymbols = ['❄', '❅', '❆'];
      
      for (let i = 0; i < 20; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        snowflake.innerHTML = snowflakeSymbols[Math.floor(Math.random() * snowflakeSymbols.length)];
        snowflake.style.left = `${Math.random() * 100}%`;
        snowflake.style.animationDelay = `${Math.random() * 10}s`;
        snowflake.style.fontSize = `${Math.random() * 10 + 15}px`;
        winterBg.appendChild(snowflake);
      }
      
      for (let i = 0; i < 5; i++) {
        const crystal = document.createElement('div');
        crystal.className = 'ice-crystal';
        crystal.innerHTML = '✦';
        crystal.style.left = `${Math.random() * 90}%`;
        crystal.style.top = `${Math.random() * 90}%`;
        crystal.style.animationDelay = `${Math.random() * 8}s`;
        crystal.style.fontSize = `${Math.random() * 10 + 25}px`;
        winterBg.appendChild(crystal);
      }
    }

    function initializeCaptcha() {
      generateCaptcha();
    }

    function generateCaptcha() {
      const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789';
      let captcha = '';
      for (let i = 0; i < 6; i++) {
        captcha += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      currentCaptcha = captcha;
      if (elements.captchaText) {
        elements.captchaText.textContent = captcha;
      }
    }

    function setupEventListeners() {
      // Navigation between forms - ตรวจสอบว่า elements มีอยู่ก่อน
      if (elements.gotoRegister && elements.loginCard && elements.registerCard) {
        elements.gotoRegister.addEventListener('click', () => {
          elements.loginCard.style.display = 'none';
          elements.registerCard.style.display = 'block';
          resetFormErrors('login');
        });
      }
      
      if (elements.gotoLogin && elements.registerCard && elements.loginCard) {
        elements.gotoLogin.addEventListener('click', () => {
          elements.registerCard.style.display = 'none';
          elements.loginCard.style.display = 'block';
          resetFormErrors('register');
        });
      }
      
      // Form submissions
      if (elements.loginForm) {
        elements.loginForm.addEventListener('submit', handleLogin);
      }
      
      if (elements.registerForm) {
        elements.registerForm.addEventListener('submit', handleRegister);
      }
      
      // Password toggle
      if (elements.toggleLoginPassword) {
        elements.toggleLoginPassword.addEventListener('click', () => {
          togglePasswordVisibility('login-password', 'toggle-login-password');
        });
      }
      
      if (elements.toggleRegisterPassword) {
        elements.toggleRegisterPassword.addEventListener('click', () => {
          togglePasswordVisibility('register-password', 'toggle-register-password');
        });
      }
      
      if (elements.toggleConfirmPassword) {
        elements.toggleConfirmPassword.addEventListener('click', () => {
          togglePasswordVisibility('confirm-password', 'toggle-confirm-password');
        });
      }
      
      // Captcha refresh
      if (elements.refreshCaptcha) {
        elements.refreshCaptcha.addEventListener('click', generateCaptcha);
      }
      
      // Password strength check
      if (elements.registerPassword) {
        elements.registerPassword.addEventListener('input', checkPasswordStrength);
      }
      
      if (elements.confirmPassword) {
        elements.confirmPassword.addEventListener('input', checkPasswordMatch);
      }
      
      // Username validation
      if (elements.registerUsername) {
        elements.registerUsername.addEventListener('blur', validateUsername);
      }
      
      // Email validation - แก้ไขให้แน่ใจว่าใช้ elements ที่ถูกต้อง
      if (elements.registerEmail) {
        elements.registerEmail.addEventListener('blur', () => {
          validateEmail(elements.registerEmail, 'register');
        });
      }
      
      if (elements.loginEmail) {
        elements.loginEmail.addEventListener('blur', () => {
          validateEmail(elements.loginEmail, 'login');
        });
      }
      
      // OTP handling
      if (elements.otpInputs) {
        elements.otpInputs.forEach((input, index) => {
          if (input) {
            input.addEventListener('input', (e) => {
              handleOTPInput(e, index);
            });
            
            input.addEventListener('keydown', (e) => {
              if (e.key === 'Backspace' && !input.value && index > 0) {
                const prevInput = elements.otpInputs[index - 1];
                if (prevInput) {
                  prevInput.focus();
                }
              }
            });
          }
        });
      }
      
      if (elements.verifyOtp) {
        elements.verifyOtp.addEventListener('click', verifyOTP);
      }
      
      if (elements.resendOtp) {
        elements.resendOtp.addEventListener('click', resendOTP);
      }
      
      // Terms modal
      document.querySelectorAll('.terms-link').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          if (elements.termsModal) {
            elements.termsModal.classList.add('active');
          }
        });
      });
      
      if (elements.closeTerms) {
        elements.closeTerms.addEventListener('click', () => {
          if (elements.termsModal) {
            elements.termsModal.classList.remove('active');
          }
        });
      }
      
      // Forgot password
      if (elements.forgotPassword) {
        elements.forgotPassword.addEventListener('click', (e) => {
          e.preventDefault();
          showNotification('Password reset feature coming soon!', 'info');
        });
      }
      
      // Notification close
      if (elements.notificationClose) {
        elements.notificationClose.addEventListener('click', hideNotification);
      }
      
      // Auto-hide notification after 5 seconds
      setInterval(() => {
        if (elements.notification && elements.notification.classList.contains('show')) {
          hideNotification();
        }
      }, 5000);
    }

    function checkExistingSession() {
      const session = localStorage.getItem('yanz_session');
      if (session) {
        try {
          const sessionData = JSON.parse(session);
          const expiresAt = sessionData.expiresAt || 0;
          
          if (Date.now() < expiresAt) {
            window.location.href = 'https://lphisv5.github.io/v4/Main.html';
          } else {
            localStorage.removeItem('yanz_session');
            localStorage.removeItem('yanz_user');
          }
        } catch (error) {
          localStorage.removeItem('yanz_session');
          localStorage.removeItem('yanz_user');
        }
      }
    }

    function togglePasswordVisibility(passwordId, toggleId) {
      const passwordInput = document.getElementById(passwordId);
      const toggleIcon = document.getElementById(toggleId);
      
      if (!passwordInput || !toggleIcon) return;
      
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.className = 'fas fa-eye-slash input-icon';
      } else {
        passwordInput.type = 'password';
        toggleIcon.className = 'fas fa-eye input-icon';
      }
    }

    function validateUsername() {
      if (!elements.registerUsername || !elements.registerUsername.value) {
        showError('username', 'Username is required');
        return false;
      }
      
      const username = elements.registerUsername.value.trim();
      const errorElement = elements.errorMessages.username;
      
      if (!username) {
        showError('username', 'Username is required');
        return false;
      }
      
      if (username.length < 3 || username.length > 20) {
        showError('username', 'Username must be 3-20 characters');
        return false;
      }
      
      if (!/^[a-zA-Z0-9_]+$/.test(username)) {
        showError('username', 'Only letters, numbers and underscores allowed');
        return false;
      }
      
      // Check if username exists (in a real app, this would be an API call)
      hideError('username');
      return true;
    }

    function validateEmail(inputElement, formType = 'register') {
      // ตรวจสอบว่า inputElement มีอยู่และมีค่า
      if (!inputElement || !inputElement.value) {
        const errorKey = formType === 'login' ? 'loginEmail' : 'email';
        showError(errorKey, 'Email is required');
        return false;
      }
      
      const email = inputElement.value.trim();
      const errorElement = formType === 'login' 
        ? elements.errorMessages.loginEmail 
        : elements.errorMessages.email;
      const errorKey = formType === 'login' ? 'loginEmail' : 'email';
      
      // ตรวจสอบว่า errorElement มีอยู่ก่อนใช้งาน
      if (!errorElement) {
        console.error('Error element not found for:', errorKey);
        return false;
      }
      
      if (!email) {
        showError(errorKey, 'Email is required');
        return false;
      }
      
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        showError(errorKey, 'Please enter a valid email address');
        return false;
      }
      
      hideError(errorKey);
      return true;
    }

    function checkPasswordStrength() {
      if (!elements.registerPassword || !elements.registerPassword.value) {
        showError('password', 'Password is required');
        return false;
      }
      
      const password = elements.registerPassword.value;
      const requirements = {
        length: password.length >= 8,
        uppercase: /[A-Z]/.test(password),
        lowercase: /[a-z]/.test(password),
        number: /\d/.test(password),
        special: /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)
      };
      
      // Update requirement indicators
      Object.keys(requirements).forEach(req => {
        const element = document.getElementById(`req-${req}`);
        if (element) {
          if (requirements[req]) {
            element.classList.remove('invalid');
            element.classList.add('valid');
            element.innerHTML = `<i class="fas fa-check-circle"></i> ${element.textContent.replace('●', '').trim()}`;
          } else {
            element.classList.remove('valid');
            element.classList.add('invalid');
            element.innerHTML = `<i class="fas fa-circle"></i> ${element.textContent.replace('✓', '').trim()}`;
          }
        }
      });
      
      // Calculate strength
      const strength = Object.values(requirements).filter(Boolean).length;
      const strengthPercent = (strength / 5) * 100;
      
      // Update strength bar
      if (elements.passwordStrengthBar) {
        elements.passwordStrengthBar.style.width = `${strengthPercent}%`;
        elements.passwordStrengthBar.className = 'password-strength-bar';
        
        if (strengthPercent <= 20) {
          elements.passwordStrengthBar.classList.add('strength-weak');
        } else if (strengthPercent <= 40) {
          elements.passwordStrengthBar.classList.add('strength-fair');
        } else if (strengthPercent <= 60) {
          elements.passwordStrengthBar.classList.add('strength-good');
        } else {
          elements.passwordStrengthBar.classList.add('strength-strong');
        }
      }
      
      // Validate password
      const errorElement = elements.errorMessages.password;
      if (!password) {
        showError('password', 'Password is required');
        return false;
      }
      
      if (strength < 3) {
        showError('password', 'Password is too weak');
        return false;
      }
      
      hideError('password');
      return true;
    }

    function checkPasswordMatch() {
      if (!elements.registerPassword || !elements.confirmPassword) {
        showError('confirmPassword', 'Please confirm your password');
        return false;
      }
      
      const password = elements.registerPassword.value;
      const confirm = elements.confirmPassword.value;
      
      if (!confirm) {
        showError('confirmPassword', 'Please confirm your password');
        return false;
      }
      
      if (password !== confirm) {
        showError('confirmPassword', 'Passwords do not match');
        return false;
      }
      
      hideError('confirmPassword');
      return true;
    }

    async function handleLogin(e) {
      e.preventDefault();
      
      // Reset errors
      resetFormErrors('login');
      
      // Validate inputs
      if (!elements.loginEmail || !elements.loginPassword) return;
      
      const emailValid = validateEmail(elements.loginEmail, 'login');
      const password = elements.loginPassword.value;
      const captcha = elements.captchaInput ? elements.captchaInput.value : '';
      
      if (!password) {
        showError('loginPassword', 'Password is required');
        return;
      }
      
      if (!captcha) {
        showError('captcha', 'Please enter the CAPTCHA code');
        return;
      }
      
      if (captcha !== currentCaptcha) {
        showError('captcha', 'Incorrect CAPTCHA code');
        generateCaptcha();
        return;
      }
      
      if (!emailValid) return;
      
      // Disable submit button
      if (elements.loginSubmit) {
        elements.loginSubmit.disabled = true;
        elements.loginSubmit.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing In...';
      }
      
      try {
        // ใน real app ควรใช้ Firebase Authentication
        // นี้เป็น demo สำหรับ testing
        if (password === 'password123' && elements.loginEmail.value.includes('@')) {
          // สำหรับ testing ให้ล็อกอินสำเร็จ
          const userData = {
            email: elements.loginEmail.value,
            username: elements.loginEmail.value.split('@')[0],
            tier: 'premium',
            sessionId: 'demo_session_' + Date.now()
          };
          
          // Store session
          const session = {
            userId: 'demo_user_' + Date.now(),
            username: userData.username,
            email: userData.email,
            tier: userData.tier,
            sessionId: userData.sessionId,
            expiresAt: Date.now() + 24 * 60 * 60 * 1000 // 24 hours
          };
          
          localStorage.setItem('yanz_session', JSON.stringify(session));
          localStorage.setItem('yanz_user', JSON.stringify(userData));
          
          showNotification('Login successful! Redirecting...', 'success');
          
          // Redirect to dashboard after 1 second
          setTimeout(() => {
            window.location.href = 'https://lphisv5.github.io/v4/';
          }, 1000);
          
        } else {
          // ถ้าใช้ Firebase จริง
          try {
            if (window.authSystem) {
              const result = await window.authSystem.loginUser(
                elements.loginEmail.value, 
                password
              );
              
              if (result.success) {
                const session = {
                  userId: result.userId,
                  username: result.username,
                  email: result.email,
                  tier: result.tier,
                  sessionId: result.sessionId,
                  expiresAt: Date.now() + 24 * 60 * 60 * 1000
                };
                
                localStorage.setItem('yanz_session', JSON.stringify(session));
                localStorage.setItem('yanz_user', JSON.stringify({
                  email: result.email,
                  username: result.username,
                  tier: result.tier,
                  sessionId: result.sessionId
                }));
                
                showNotification('Login successful! Redirecting...', 'success');
                
                setTimeout(() => {
                  window.location.href = 'https://lphisv5.github.io/v4/Main.html';
                }, 1000);
              }
            }
          } catch (firebaseError) {
            throw new Error(firebaseError.message || 'Invalid email or password');
          }
        }
        
      } catch (error) {
        showError('loginPassword', error.message);
        generateCaptcha();
      } finally {
        if (elements.loginSubmit) {
          elements.loginSubmit.disabled = false;
          elements.loginSubmit.innerHTML = '<i class="fas fa-sign-in-alt"></i> Sign In';
        }
      }
    }

    async function handleRegister(e) {
      e.preventDefault();
      
      // Reset errors
      resetFormErrors('register');
      
      // Validate all inputs
      const usernameValid = validateUsername();
      const emailValid = elements.registerEmail ? validateEmail(elements.registerEmail) : false;
      const passwordValid = checkPasswordStrength();
      const confirmValid = checkPasswordMatch();
      const termsAgreed = elements.termsAgree ? elements.termsAgree.checked : false;
      
      if (!termsAgreed) {
        showError('terms', 'You must agree to the terms and conditions');
        return;
      }
      
      if (!usernameValid || !emailValid || !passwordValid || !confirmValid) {
        return;
      }
      
      // Disable submit button
      if (elements.registerSubmit) {
        elements.registerSubmit.disabled = true;
        elements.registerSubmit.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Account...';
      }
      
      try {
        // Generate OTP
        currentOTP = Math.floor(100000 + Math.random() * 900000).toString();
        currentEmail = elements.registerEmail ? elements.registerEmail.value : '';
        
        // Send OTP via EmailJS
        if (window.authSystem) {
          try {
            await window.authSystem.sendVerificationEmail(currentEmail, currentOTP);
            showNotification(`Verification OTP has been sent to ${currentEmail}`, 'success');
          } catch (emailError) {
            // ถ้าส่งอีเมลไม่สำเร็จ ให้แสดง OTP ใน console
            console.log(`OTP for ${currentEmail}: ${currentOTP}`);
            showNotification(`OTP sent (check console if not received): ${currentOTP}`, 'warning');
          }
        } else {
          // Fallback ถ้า authSystem ไม่มี
          currentOTP = Math.floor(100000 + Math.random() * 900000).toString();
          console.log(`Demo OTP for ${currentEmail}: ${currentOTP}`);
          showNotification(`Demo OTP: ${currentOTP} (Check console for demo)`, 'info');
        }
        
        // Show OTP screen
        if (elements.registerCard && elements.otpCard) {
          elements.registerCard.style.display = 'none';
          elements.otpCard.style.display = 'block';
        }
        
        // Clear OTP inputs
        if (elements.otpInputs) {
          elements.otpInputs.forEach(input => {
            if (input) input.value = '';
          });
        }
        
        // Start OTP timer
        startOTPTimer(300); // 5 minutes
        
        // Start resend timer
        startResendTimer(60);
        
      } catch (error) {
        showNotification('Registration failed: ' + error.message, 'error');
      } finally {
        if (elements.registerSubmit) {
          elements.registerSubmit.disabled = false;
          elements.registerSubmit.innerHTML = '<i class="fas fa-user-plus"></i> Create Account';
        }
      }
    }

    function handleOTPInput(e, index) {
      const input = e.target;
      const value = input.value;
      
      // Only allow numbers
      if (!/^\d?$/.test(value)) {
        input.value = '';
        return;
      }
      
      // Move to next input if current is filled
      if (value && index < elements.otpInputs.length - 1) {
        const nextInput = elements.otpInputs[index + 1];
        if (nextInput) {
          nextInput.focus();
        }
      }
      
      // Auto verify if all inputs are filled
      if (index === elements.otpInputs.length - 1 && value) {
        const allFilled = Array.from(elements.otpInputs).every(input => input && input.value);
        if (allFilled) {
          verifyOTP();
        }
      }
    }

    async function verifyOTP() {
      if (!elements.otpInputs) return;
      
      const otp = Array.from(elements.otpInputs)
        .map(input => input ? input.value : '')
        .join('');
      
      if (otp.length !== 6) {
        showError('otp', 'Please enter the complete 6-digit code');
        return;
      }
      
      // Disable verify button
      if (elements.verifyOtp) {
        elements.verifyOtp.disabled = true;
        elements.verifyOtp.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Verifying...';
      }
      
      try {
        // Verify OTP
        if (window.authSystem) {
          const result = await window.authSystem.verifyOTP(currentEmail, otp);
          
          if (result.success) {
            // Create user account in Firebase
            const userData = {
              username: elements.registerUsername ? elements.registerUsername.value : '',
              email: currentEmail,
              password: elements.registerPassword ? elements.registerPassword.value : '',
              verified: true
            };
            
            const registerResult = await window.authSystem.registerUser(userData);
            
            if (registerResult.success) {
              showNotification('Email verified successfully! Creating your account...', 'success');
              
              await new Promise(resolve => setTimeout(resolve, 1500));
              
              // Store session
              const session = {
                userId: registerResult.userId,
                username: userData.username,
                email: userData.email,
                tier: 'free',
                sessionId: 'session_' + Date.now(),
                expiresAt: Date.now() + 24 * 60 * 60 * 1000
              };
              
              localStorage.setItem('yanz_session', JSON.stringify(session));
              localStorage.setItem('yanz_user', JSON.stringify({
                email: userData.email,
                username: userData.username,
                tier: 'free',
                sessionId: session.sessionId
              }));
              
              showNotification('Account created successfully! Redirecting...', 'success');
              
              setTimeout(() => {
                window.location.href = 'https://lphisv5.github.io/v4/Main.html';
              }, 1000);
            }
          }
        } else {
          await new Promise(resolve => setTimeout(resolve, 1000));
          
          if (otp === currentOTP) {
            showNotification('Email verified successfully! Creating your account...', 'success');
            
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            const userData = {
              email: currentEmail,
              username: elements.registerUsername ? elements.registerUsername.value : '',
              tier: 'free',
              sessionId: 'demo_session_' + Date.now()
            };
            
            const session = {
              userId: 'demo_user_' + Date.now(),
              username: userData.username,
              email: userData.email,
              tier: userData.tier,
              sessionId: userData.sessionId,
              expiresAt: Date.now() + 24 * 60 * 60 * 1000
            };
            
            localStorage.setItem('yanz_session', JSON.stringify(session));
            localStorage.setItem('yanz_user', JSON.stringify(userData));
            
            showNotification('Account created successfully! Redirecting...', 'success');
            
            setTimeout(() => {
              window.location.href = 'https://lphisv5.github.io/v4/';
            }, 1000);
            
          } else {
            throw new Error('Invalid verification code');
          }
        }
        
      } catch (error) {
        showError('otp', error.message);
        if (elements.otpInputs) {
          elements.otpInputs.forEach(input => {
            if (input) input.value = '';
          });
          if (elements.otpInputs[0]) {
            elements.otpInputs[0].focus();
          }
        }
      } finally {
        if (elements.verifyOtp) {
          elements.verifyOtp.disabled = false;
          elements.verifyOtp.innerHTML = '<i class="fas fa-check-circle"></i> Verify Account';
        }
      }
    }

    async function resendOTP() {
      if (!isResendEnabled) return;
      
      currentOTP = Math.floor(100000 + Math.random() * 900000).toString();
      
      if (window.authSystem) {
        try {
          await window.authSystem.sendVerificationEmail(currentEmail, currentOTP);
          showNotification(`New verification OTP has been sent to ${currentEmail}`, 'success');
        } catch (emailError) {
          console.log(`New OTP for ${currentEmail}: ${currentOTP}`);
          showNotification(`New OTP sent (check console if not received): ${currentOTP}`, 'warning');
        }
      } else {
        console.log(`New demo OTP for ${currentEmail}: ${currentOTP}`);
        showNotification(`New demo OTP: ${currentOTP}`, 'info');
      }
      
      if (elements.otpInputs) {
        elements.otpInputs.forEach(input => {
          if (input) input.value = '';
        });
        if (elements.otpInputs[0]) {
          elements.otpInputs[0].focus();
        }
      }
      
      hideError('otp');
      
      startResendTimer(60);
    }

    function startOTPTimer(duration) {
      let timeLeft = duration;
      
      const timer = setInterval(() => {
        timeLeft--;
        
        if (elements.otpTimer) {
          const minutes = Math.floor(timeLeft / 60);
          const seconds = timeLeft % 60;
          elements.otpTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        if (timeLeft <= 0) {
          clearInterval(timer);
          showError('otp', 'Verification code has expired');
          if (elements.verifyOtp) {
            elements.verifyOtp.disabled = true;
          }
        }
      }, 1000);
    }

    function startResendTimer(duration) {
      let timeLeft = duration;
      isResendEnabled = false;
      if (elements.resendOtp) {
        elements.resendOtp.disabled = true;
      }
      
      const timer = setInterval(() => {
        timeLeft--;
        if (elements.resendTimer) {
          elements.resendTimer.textContent = timeLeft;
        }
        
        if (timeLeft <= 0) {
          clearInterval(timer);
          isResendEnabled = true;
          if (elements.resendOtp) {
            elements.resendOtp.disabled = false;
            if (elements.resendTimer) {
              elements.resendTimer.textContent = '';
            }
            elements.resendOtp.innerHTML = '<i class="fas fa-redo"></i> Resend Code';
          }
        }
      }, 1000);
    }

    function showError(field, message) {
      const errorElement = elements.errorMessages ? elements.errorMessages[field] : null;
      if (errorElement) {
        errorElement.textContent = message;
        errorElement.classList.add('show');
        
        const inputId = field.toLowerCase().replace('error', '').replace(/([a-z])([A-Z])/g, '$1-$2');
        const inputElement = document.getElementById(inputId);
        if (inputElement) {
          inputElement.classList.add('error');
        }
      }
    }

    function hideError(field) {
      const errorElement = elements.errorMessages ? elements.errorMessages[field] : null;
      if (errorElement) {
        errorElement.classList.remove('show');
        
        const inputId = field.toLowerCase().replace('error', '').replace(/([a-z])([A-Z])/g, '$1-$2');
        const inputElement = document.getElementById(inputId);
        if (inputElement) {
          inputElement.classList.remove('error');
        }
      }
    }

    function resetFormErrors(formType) {
      if (formType === 'login') {
        hideError('loginEmail');
        hideError('loginPassword');
        hideError('captcha');
        if (elements.loginEmail) elements.loginEmail.classList.remove('error');
        if (elements.loginPassword) elements.loginPassword.classList.remove('error');
        if (elements.captchaInput) elements.captchaInput.classList.remove('error');
      } else if (formType === 'register') {
        hideError('username');
        hideError('email');
        hideError('password');
        hideError('confirmPassword');
        hideError('terms');
        if (elements.registerUsername) elements.registerUsername.classList.remove('error');
        if (elements.registerEmail) elements.registerEmail.classList.remove('error');
        if (elements.registerPassword) elements.registerPassword.classList.remove('error');
        if (elements.confirmPassword) elements.confirmPassword.classList.remove('error');
      } else if (formType === 'otp') {
        hideError('otp');
      }
    }

    function showNotification(message, type = 'info') {
      if (!elements.notification || !elements.notificationMessage) return;
      
      elements.notificationMessage.textContent = message;
      elements.notification.className = `notification show`;
      
      if (type === 'success') {
        elements.notification.style.borderLeftColor = '#81c784';
      } else if (type === 'error') {
        elements.notification.style.borderLeftColor = '#e57373';
      } else if (type === 'warning') {
        elements.notification.style.borderLeftColor = '#ffb74d';
      } else {
        elements.notification.style.borderLeftColor = '#4fc3f7';
      }
      
      setTimeout(() => {
        hideNotification();
      }, 5000);
    }

    function hideNotification() {
      if (elements.notification) {
        elements.notification.classList.remove('show');
      }
    }

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        if (elements.loginCard && elements.loginCard.style.display !== 'none') {
          if (document.activeElement !== elements.captchaInput) {
            if (elements.loginForm) {
              elements.loginForm.requestSubmit();
            }
          }
        } else if (elements.registerCard && elements.registerCard.style.display !== 'none') {
          if (elements.registerForm) {
            elements.registerForm.requestSubmit();
          }
        }
      }
    });
  </script>
</body>
</html>
