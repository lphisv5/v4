<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="YANZ, lphisv5, tools, scripts, systems, web hub, productivity tools">
  <meta name="google-site-verification" content="JBRMY2D-joTthmVgUJIx5_U7CER2SosgBqEcoRGmzp0">
  <meta name="theme-color" content="#0c1b33">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="YANZ">
  
  <link rel="canonical" href="https://lphisv5.github.io/v4/">
  <link rel="icon" href="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg" type="image/png">
  <link rel="apple-touch-icon" href="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg">
  <meta name="author" content="YANZ">
  <title>Secure Access - YANZ</title>
  <meta name="description" content="YANZ Winter Edition - Secure tools collection with advanced authentication.">

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  
  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  
  <!-- Fonts and Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
  
  <style>
    :root {
      --primary-bg: #0c1b33;
      --secondary-bg: #1e3a5f;
      --accent-color: #4fc3f7;
      --accent-secondary: #29b6f6;
      --winter-blue: #4fc3f7;
      --winter-light-blue: #b3e5fc;
      --winter-white: #e1f5fe;
      --winter-silver: #eceff1;
      --text-primary: #f8fafc;
      --text-secondary: #e2e8f0;
      --text-muted: #a0aec0;
      --success-color: #81c784;
      --error-color: #e57373;
      --warning-color: #ffb74d;
      --card-bg: rgba(30, 58, 95, 0.8);
      --card-hover-bg: rgba(41, 98, 158, 0.9);
      --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
      --card-hover-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --border-radius: 12px;
      --border-radius-lg: 16px;
      --border-radius-xl: 24px;
      
      --space-xs: 0.5rem;
      --space-sm: 1rem;
      --space-md: 1.5rem;
      --space-lg: 2rem;
      --space-xl: 3rem;
      
      --font-size-xs: 0.75rem;
      --font-size-sm: 0.875rem;
      --font-size-base: 1rem;
      --font-size-lg: 1.125rem;
      --font-size-xl: 1.25rem;
      --font-size-2xl: 1.5rem;
      --font-size-3xl: 1.875rem;
      --font-size-4xl: 2.25rem;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    @keyframes winter-glow {
      0%, 100% { box-shadow: 0 0 5px var(--winter-blue), 0 0 10px var(--winter-blue); }
      50% { box-shadow: 0 0 15px var(--winter-blue), 0 0 30px var(--winter-blue); }
    }

    @keyframes snow-fall {
      0% { transform: translateY(-100px) translateX(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) translateX(20px) rotate(360deg); opacity: 0; }
    }

    @keyframes snowflake-float {
      0%, 100% { transform: translateY(0) translateX(0); opacity: 0.7; }
      25% { transform: translateY(-10px) translateX(10px); opacity: 0.9; }
      50% { transform: translateY(-5px) translateX(-10px); opacity: 0.8; }
      75% { transform: translateY(-8px) translateX(5px); opacity: 0.9; }
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      font-size: 16px;
    }

    body {
      font-family: 'Inter', sans-serif;
      color: var(--text-primary);
      background: var(--primary-bg);
      line-height: 1.6;
      overflow-x: hidden;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      position: relative;
    }

    .winter-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
      background: linear-gradient(to bottom, var(--primary-bg), var(--secondary-bg), var(--primary-bg));
    }

    .snowflake {
      position: absolute;
      color: var(--winter-white);
      font-size: 20px;
      animation: snow-fall 10s linear infinite;
      z-index: -1;
      opacity: 0.7;
      user-select: none;
    }

    .ice-crystal {
      position: absolute;
      font-size: 30px;
      color: var(--winter-light-blue);
      animation: snowflake-float 8s ease-in-out infinite;
      z-index: -1;
      opacity: 0.5;
    }

    .security-badges {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
      display: flex;
      gap: 5px;
    }

    .security-badge {
      background: rgba(30, 58, 95, 0.8);
      backdrop-filter: blur(10px);
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 11px;
      color: var(--winter-blue);
      border: 1px solid rgba(79, 195, 247, 0.3);
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--primary-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }

    .loader.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .loader-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(79, 195, 247, 0.3);
      border-top: 4px solid var(--winter-blue);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: var(--space-md);
    }

    .loader-text {
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
    }

    .auth-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--space-xl) var(--space-md);
    }

    .auth-card {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border-radius: var(--border-radius-xl);
      padding: var(--space-xl);
      width: 100%;
      max-width: 500px;
      border: 1px solid rgba(79, 195, 247, 0.3);
      box-shadow: var(--card-hover-shadow);
      position: relative;
      overflow: hidden;
    }

    .auth-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--winter-blue), var(--winter-light-blue), var(--winter-white));
    }

    .auth-header {
      text-align: center;
      margin-bottom: var(--space-xl);
    }

    .auth-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-sm);
      margin-bottom: var(--space-lg);
      text-decoration: none;
    }

    .auth-logo img {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 2px solid var(--winter-blue);
      animation: winter-glow 3s infinite;
    }

    .auth-logo-text {
      font-size: var(--font-size-2xl);
      font-weight: 700;
      background: linear-gradient(135deg, var(--winter-blue), var(--winter-light-blue));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .auth-title {
      font-size: var(--font-size-2xl);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-xs);
    }

    .auth-subtitle {
      color: var(--text-secondary);
      font-size: var(--font-size-base);
    }

    .auth-form {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }

    .form-group {
      position: relative;
    }

    .form-label {
      display: block;
      margin-bottom: var(--space-xs);
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
      font-weight: 500;
    }

    .form-label.required::after {
      content: ' *';
      color: var(--error-color);
    }

    .form-input {
      width: 100%;
      padding: 0.875rem 1rem;
      background: rgba(30, 58, 95, 0.5);
      border: 1px solid rgba(79, 195, 247, 0.3);
      border-radius: var(--border-radius);
      color: var(--text-primary);
      font-family: 'Inter', sans-serif;
      transition: var(--transition);
      font-size: var(--font-size-base);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--winter-blue);
      box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.3);
    }

    .form-input.error {
      border-color: var(--error-color);
    }

    .input-with-icon {
      position: relative;
    }

    .input-icon {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
      cursor: pointer;
    }

    .error-message {
      color: var(--error-color);
      font-size: var(--font-size-xs);
      margin-top: 0.25rem;
      display: none;
    }

    .error-message.show {
      display: block;
    }

    .password-strength {
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 2px;
      margin-top: 0.25rem;
      overflow: hidden;
    }

    .password-strength-bar {
      height: 100%;
      width: 0%;
      transition: var(--transition);
      border-radius: 2px;
    }

    .strength-weak { background: var(--error-color); }
    .strength-fair { background: var(--warning-color); }
    .strength-good { background: #ffd166; }
    .strength-strong { background: var(--success-color); }

    .password-requirements {
      margin-top: 0.5rem;
      font-size: var(--font-size-xs);
      color: var(--text-muted);
    }

    .requirement {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      margin-bottom: 0.125rem;
    }

    .requirement.valid {
      color: var(--success-color);
    }

    .requirement.invalid {
      color: var(--text-muted);
    }

    .captcha-container {
      background: rgba(30, 58, 95, 0.5);
      border-radius: var(--border-radius);
      padding: var(--space-sm);
      border: 1px solid rgba(79, 195, 247, 0.3);
    }

    .captcha-text {
      font-family: monospace;
      font-size: 1.5rem;
      letter-spacing: 5px;
      text-align: center;
      background: linear-gradient(90deg, var(--winter-blue), var(--winter-light-blue));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      padding: 0.5rem;
      margin-bottom: var(--space-sm);
      user-select: none;
    }

    .captcha-refresh {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--winter-blue);
      cursor: pointer;
      transition: var(--transition);
    }

    .captcha-refresh:hover {
      color: var(--winter-light-blue);
    }

    .terms-container {
      display: flex;
      align-items: flex-start;
      gap: var(--space-xs);
      margin: var(--space-md) 0;
    }

    .terms-checkbox {
      margin-top: 0.25rem;
    }

    .terms-label {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      line-height: 1.4;
    }

    .terms-link {
      color: var(--winter-blue);
      text-decoration: none;
      transition: var(--transition);
    }

    .terms-link:hover {
      text-decoration: underline;
    }

    .auth-buttons {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
      margin-top: var(--space-lg);
    }

    .btn {
      padding: 0.875rem 1.5rem;
      border-radius: var(--border-radius);
      border: none;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      font-size: var(--font-size-base);
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--winter-blue), var(--winter-light-blue));
      color: #0c1b33;
      box-shadow: 0 4px 12px rgba(79, 195, 247, 0.4);
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(79, 195, 247, 0.6);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid rgba(79, 195, 247, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(79, 195, 247, 0.1);
      color: var(--winter-blue);
      border-color: var(--winter-blue);
    }

    .auth-links {
      text-align: center;
      margin-top: var(--space-lg);
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
    }

    .auth-link {
      color: var(--winter-blue);
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
    }

    .auth-link:hover {
      text-decoration: underline;
    }

    .otp-container {
      text-align: center;
    }

    .otp-inputs {
      display: flex;
      gap: var(--space-sm);
      justify-content: center;
      margin: var(--space-lg) 0;
    }

    .otp-input {
      width: 50px;
      height: 60px;
      text-align: center;
      font-size: var(--font-size-2xl);
      background: rgba(30, 58, 95, 0.5);
      border: 1px solid rgba(79, 195, 247, 0.3);
      border-radius: var(--border-radius);
      color: var(--text-primary);
      transition: var(--transition);
    }

    .otp-input:focus {
      outline: none;
      border-color: var(--winter-blue);
      box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.3);
    }

    .otp-timer {
      color: var(--text-muted);
      font-size: var(--font-size-sm);
      margin-top: var(--space-sm);
    }

    .otp-resend {
      background: none;
      border: none;
      color: var(--winter-blue);
      cursor: pointer;
      font-size: var(--font-size-sm);
      transition: var(--transition);
    }

    .otp-resend:hover:not(:disabled) {
      text-decoration: underline;
    }

    .otp-resend:disabled {
      color: var(--text-muted);
      cursor: not-allowed;
    }

    .security-info {
      background: rgba(30, 58, 95, 0.3);
      border-radius: var(--border-radius);
      padding: var(--space-md);
      margin-top: var(--space-lg);
      border: 1px solid rgba(79, 195, 247, 0.2);
    }

    .security-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-primary);
      font-size: var(--font-size-sm);
      margin-bottom: var(--space-xs);
    }

    .security-list {
      list-style: none;
      font-size: var(--font-size-xs);
      color: var(--text-secondary);
    }

    .security-list li {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.25rem;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      padding: var(--space-md);
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: var(--secondary-bg);
      border-radius: var(--border-radius-lg);
      padding: var(--space-xl);
      max-width: 500px;
      width: 100%;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(79, 195, 247, 0.3);
      position: relative;
    }

    .modal-header {
      text-align: center;
      margin-bottom: var(--space-lg);
    }

    .modal-title {
      font-size: var(--font-size-xl);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-xs);
    }

    .modal-subtitle {
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
    }

    .notification {
      position: fixed;
      bottom: var(--space-lg);
      right: var(--space-lg);
      background: var(--secondary-bg);
      color: var(--text-primary);
      padding: var(--space-md);
      border-radius: var(--border-radius);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      z-index: 1001;
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      transform: translateY(100px);
      opacity: 0;
      transition: var(--transition);
      max-width: 400px;
      border-left: 4px solid var(--winter-blue);
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    .notification-close {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      margin-left: auto;
      transition: var(--transition);
    }

    .notification-close:hover {
      color: var(--text-primary);
    }

    @media (max-width: 768px) {
      .auth-card {
        padding: var(--space-lg);
      }
      
      .otp-input {
        width: 45px;
        height: 55px;
        font-size: var(--font-size-xl);
      }
      
      .security-badges {
        display: none;
      }
    }

    @media (max-width: 480px) {
      .auth-card {
        padding: var(--space-md);
      }
      
      .otp-inputs {
        gap: var(--space-xs);
      }
      
      .otp-input {
        width: 40px;
        height: 50px;
        font-size: var(--font-size-lg);
      }
    }
  </style>
</head>
<body>
  <div class="winter-bg" id="winter-bg"></div>

  <div class="security-badges">
    <div class="security-badge">
      <i class="fas fa-shield-alt"></i> SSL Secured
    </div>
    <div class="security-badge">
      <i class="fas fa-lock"></i> AES-256
    </div>
  </div>

  <div class="loader" id="loader">
    <div style="text-align: center;">
      <div class="loader-spinner"></div>
      <div class="loader-text">Initializing Security Systems...</div>
    </div>
  </div>

  <div class="auth-container" id="auth-container">
    <!-- Login Card -->
    <div class="auth-card" id="login-card">
      <div class="auth-header">
        <a href="#" class="auth-logo">
          <img src="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg" alt="YANZ Logo">
          <span class="auth-logo-text">YANZ</span>
        </a>
        <h1 class="auth-title">Welcome Back</h1>
        <p class="auth-subtitle">Sign in to access your tools dashboard</p>
      </div>

      <form class="auth-form" id="login-form">
        <div class="form-group">
          <label for="login-email" class="form-label required">Email Address</label>
          <input type="email" id="login-email" class="form-input" placeholder="Enter your email" required>
          <div class="error-message" id="login-email-error"></div>
        </div>

        <div class="form-group">
          <label for="login-password" class="form-label required">Password</label>
          <div class="input-with-icon">
            <input type="password" id="login-password" class="form-input" placeholder="Enter your password" required>
            <i class="fas fa-eye input-icon" id="toggle-login-password"></i>
          </div>
          <div class="error-message" id="login-password-error"></div>
        </div>

        <div class="form-group">
          <div class="captcha-container">
            <div class="captcha-text" id="captcha-text">ABC123</div>
            <div class="input-with-icon">
              <input type="text" id="captcha-input" class="form-input" placeholder="Enter the code above" required>
              <button type="button" class="captcha-refresh" id="refresh-captcha">
                <i class="fas fa-redo"></i>
              </button>
            </div>
          </div>
          <div class="error-message" id="captcha-error"></div>
        </div>

        <div class="auth-buttons">
          <button type="submit" class="btn btn-primary" id="login-submit">
            <i class="fas fa-sign-in-alt"></i> Sign In
          </button>
          <button type="button" class="btn btn-secondary" id="goto-register">
            <i class="fas fa-user-plus"></i> Create Account
          </button>
        </div>
      </form>

      <div class="auth-links">
        <a href="public/forgot-password.html" class="auth-link" id="forgot-password">Forgot Password?</a>
      </div>

      <div class="security-info">
        <div class="security-title">
          <i class="fas fa-shield-alt"></i>
          <span>Security Information</span>
        </div>
        <ul class="security-list">
          <li><i class="fas fa-check-circle"></i> All connections are encrypted with AES-256</li>
          <li><i class="fas fa-check-circle"></i> Rate limiting protects against brute force attacks</li>
          <li><i class="fas fa-check-circle"></i> Suspicious activity monitoring enabled</li>
        </ul>
      </div>
    </div>

    <!-- Register Card -->
    <div class="auth-card" id="register-card" style="display: none;">
      <div class="auth-header">
        <a href="#" class="auth-logo">
          <img src="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg" alt="YANZ Logo">
          <span class="auth-logo-text">YANZ</span>
        </a>
        <h2 class="auth-title">Create Account</h2>
        <p class="auth-subtitle">Join YANZ for access to premium tools</p>
      </div>

      <form class="auth-form" id="register-form">
        <div class="form-group">
          <label for="register-username" class="form-label required">Username</label>
          <input type="text" id="register-username" class="form-input" placeholder="Choose a username" required>
          <div class="error-message" id="username-error"></div>
        </div>

        <div class="form-group">
          <label for="register-email" class="form-label required">Email Address</label>
          <input type="email" id="register-email" class="form-input" placeholder="Enter your email" required>
          <div class="error-message" id="email-error"></div>
        </div>

        <div class="form-group">
          <label for="register-password" class="form-label required">Password</label>
          <div class="input-with-icon">
            <input type="password" id="register-password" class="form-input" placeholder="Create a strong password" required>
            <i class="fas fa-eye input-icon" id="toggle-register-password"></i>
          </div>
          <div class="password-strength">
            <div class="password-strength-bar" id="password-strength-bar"></div>
          </div>
          <div class="password-requirements" id="password-requirements">
            <div class="requirement invalid" id="req-length">
              <i class="fas fa-circle"></i> At least 8 characters
            </div>
            <div class="requirement invalid" id="req-uppercase">
              <i class="fas fa-circle"></i> One uppercase letter
            </div>
            <div class="requirement invalid" id="req-lowercase">
              <i class="fas fa-circle"></i> One lowercase letter
            </div>
            <div class="requirement invalid" id="req-number">
              <i class="fas fa-circle"></i> One number
            </div>
            <div class="requirement invalid" id="req-special">
              <i class="fas fa-circle"></i> One special character
            </div>
          </div>
          <div class="error-message" id="password-error"></div>
        </div>

        <div class="form-group">
          <label for="confirm-password" class="form-label required">Confirm Password</label>
          <div class="input-with-icon">
            <input type="password" id="confirm-password" class="form-input" placeholder="Confirm your password" required>
            <i class="fas fa-eye input-icon" id="toggle-confirm-password"></i>
          </div>
          <div class="error-message" id="confirm-password-error"></div>
        </div>

        <div class="terms-container">
          <input type="checkbox" id="terms-agree" class="terms-checkbox" required>
          <label for="terms-agree" class="terms-label">
            I agree to the <a href="#" class="terms-link" id="show-terms">Terms of Service</a> and <a href="#" class="terms-link" id="show-privacy">Privacy Policy</a>.
          </label>
        </div>
        <div class="error-message" id="terms-error"></div>

        <div class="auth-buttons">
          <button type="submit" class="btn btn-primary" id="register-submit">
            <i class="fas fa-user-plus"></i> Create Account
          </button>
          <button type="button" class="btn btn-secondary" id="goto-login">
            <i class="fas fa-sign-in-alt"></i> Back to Login
          </button>
        </div>
      </form>

      <div class="security-info">
        <div class="security-title">
          <i class="fas fa-user-shield"></i>
          <span>Account Security</span>
        </div>
        <ul class="security-list">
          <li><i class="fas fa-check-circle"></i> Email verification required</li>
          <li><i class="fas fa-check-circle"></i> Strong password enforcement</li>
          <li><i class="fas fa-check-circle"></i> Account activity monitoring</li>
        </ul>
      </div>
    </div>

    <!-- OTP Card -->
    <div class="auth-card" id="otp-card" style="display: none;">
      <div class="auth-header">
        <a href="#" class="auth-logo">
          <img src="https://i.postimg.cc/TPNFmJ50/a7f768b4dc4e12857e1e56f350cd2818.jpg" alt="YANZ Logo">
          <span class="auth-logo-text">YANZ</span>
        </a>
        <h2 class="auth-title">Verify Email</h2>
        <p class="auth-subtitle">Enter the 6-digit code sent to your email</p>
      </div>

      <div class="otp-container">
        <div class="otp-inputs" id="otp-inputs">
          <input type="text" class="otp-input" maxlength="1" data-index="0">
          <input type="text" class="otp-input" maxlength="1" data-index="1">
          <input type="text" class="otp-input" maxlength="1" data-index="2">
          <input type="text" class="otp-input" maxlength="1" data-index="3">
          <input type="text" class="otp-input" maxlength="1" data-index="4">
          <input type="text" class="otp-input" maxlength="1" data-index="5">
        </div>

        <div class="error-message" id="otp-error"></div>

        <div class="otp-timer">
          Code expires in: <span id="otp-timer">05:00</span>
        </div>

        <div class="auth-buttons">
          <button type="button" class="btn btn-primary" id="verify-otp">
            <i class="fas fa-check-circle"></i> Verify Account
          </button>
          <button type="button" class="btn btn-secondary" id="resend-otp" disabled>
            <i class="fas fa-redo"></i> Resend Code (<span id="resend-timer">60</span>s)
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Terms Modal -->
  <div class="modal-overlay" id="terms-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Terms of Service</h3>
        <p class="modal-subtitle">Last Updated: 2025</p>
      </div>
      <div class="modal-body">
        <div style="max-height: 400px; overflow-y: auto; padding-right: 10px;">
          <h4>1. Acceptance of Terms</h4>
          <p>By accessing and using YANZ services, you agree to be bound by these Terms of Service.</p>
          
          <h4>2. User Accounts</h4>
          <p>You must provide accurate and complete information when creating an account.</p>
          
          <h4>3. Acceptable Use</h4>
          <p>You agree not to use the service for any illegal or unauthorized purpose.</p>
          
          <h4>4. Privacy Policy</h4>
          <p>Your privacy is important to us. We collect minimal data for authentication only.</p>
          
          <h4>5. Service Modifications</h4>
          <p>We reserve the right to modify or discontinue the service at any time.</p>
        </div>
        <div style="margin-top: 20px; text-align: center;">
          <button type="button" class="btn btn-primary" id="close-terms">I Understand</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i>
    <span id="notification-message">This is a notification</span>
    <button class="notification-close" id="notification-close">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <script>
    (function() {
      emailjs.init("QRpj9mdUY5jURnFt7");
      console.log('‚úÖ EmailJS initialized');
    })();

    document.addEventListener('DOMContentLoaded', function() {
      console.log('YANZ Hub Initializing...');
      
      createWinterElements();
      initializeFirebase();
      initializeApp();
      
      setTimeout(() => {
        document.getElementById('loader').classList.add('hidden');
      }, 1500);
    });

    function createWinterElements() {
      const winterBg = document.getElementById('winter-bg');
      const snowflakeSymbols = ['‚ùÑ', '‚ùÖ', '‚ùÜ'];
      
      for (let i = 0; i < 15; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        snowflake.innerHTML = snowflakeSymbols[Math.floor(Math.random() * snowflakeSymbols.length)];
        snowflake.style.left = `${Math.random() * 100}%`;
        snowflake.style.animationDelay = `${Math.random() * 10}s`;
        snowflake.style.fontSize = `${Math.random() * 10 + 15}px`;
        winterBg.appendChild(snowflake);
      }
      
      for (let i = 0; i < 3; i++) {
        const crystal = document.createElement('div');
        crystal.className = 'ice-crystal';
        crystal.innerHTML = '‚ú¶';
        crystal.style.left = `${Math.random() * 90}%`;
        crystal.style.top = `${Math.random() * 90}%`;
        crystal.style.animationDelay = `${Math.random() * 8}s`;
        crystal.style.fontSize = `${Math.random() * 10 + 25}px`;
        winterBg.appendChild(crystal);
      }
    }

    let database = null;
    let authSystem = null;

    function initializeFirebase() {
      try {
        if (!firebase.apps.length) {
          const firebaseConfig = {
            apiKey: "AIzaSyA_sh9fh7h1gGOurALEWJAq3Y-o7vSeaCM",
            authDomain: "yanzz-6e06c.firebaseapp.com",
            databaseURL: "https://yanzz-6e06c-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "yanzz-6e06c",
            storageBucket: "yanzz-6e06c.firebasestorage.app",
            messagingSenderId: "951083749698",
            appId: "1:951083749698:web:3e279cd0dc9a9be39bf8db",
            measurementId: "G-YV2G95Z9HE"
          };

          firebase.initializeApp(firebaseConfig);
          console.log('‚úÖ Firebase initialized successfully');
        } else {
          console.log('‚úÖ Firebase already initialized');
        }
        
        // Set up database reference
        database = firebase.database();
        
        // Test database connection
        database.ref('.info/connected').on('value', (snap) => {
          if (snap.val() === true) {
            console.log('‚úÖ Database connected');
          } else {
            console.log('‚ùå Database disconnected');
          }
        });
        
      } catch (error) {
        console.error('Firebase initialization failed:', error);
      }
    }

// ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå index.html ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡πà‡∏ß‡∏ô hashPassword ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
class AuthSystem {
  constructor() {
    this.currentCaptcha = this.generateCaptcha();
    this.currentOTP = '';
    this.currentEmail = '';
    this.otpTimer = null;
    this.resendTimer = null;
    this.currentUser = null;
  }

  // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç hashPassword ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
  hashPassword(password) {
    // ‡πÉ‡∏ä‡πâ hash function ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà
    let hash = 0;
    if (password.length === 0) return hash.toString(36);
    
    for (let i = 0; i < password.length; i++) {
      const char = password.charCodeAt(i);
      hash = ((hash << 5) - hash) + char;
      hash = hash & hash; // Convert to 32bit integer
    }
    
    // ‡πÉ‡∏ä‡πâ format ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô: hash + password length
    return hash.toString(36) + '_' + password.length;
  }

  async loginUser(email, password) {
    if (!database) {
      throw new Error('Database connection failed');
    }

    try {
      console.log('üîç Attempting login for:', email);
      
      // Get all users
      const snapshot = await database.ref('users').once('value');
      
      if (!snapshot.exists()) {
        console.log('‚ùå No users found in database');
        throw new Error('Invalid email or password');
      }

      let userData = null;
      let userId = null;

      // Find user by email
      snapshot.forEach((child) => {
        const user = child.val();
        console.log('üîç Checking user:', user.email, 'against:', email);
        
        if (user.email && user.email.toLowerCase() === email.toLowerCase()) {
          userData = user;
          userId = child.key;
          console.log('‚úÖ Found user:', userId);
        }
      });

      if (!userData) {
        console.log('‚ùå User not found for email:', email);
        throw new Error('Invalid email or password');
      }

      // Debug: Show stored hash vs computed hash
      const inputHash = this.hashPassword(password);
      console.log('üîç Password check:');
      console.log('  Input password:', password);
      console.log('  Stored hash:', userData.password);
      console.log('  Computed hash:', inputHash);
      console.log('  Match?', userData.password === inputHash);

      // Verify password
      if (userData.password !== inputHash) {
        console.log('‚ùå Password mismatch');
        throw new Error('Invalid email or password');
      }

      // Check if verified
      if (!userData.verified) {
        console.log('‚ö†Ô∏è User not verified');
        throw new Error('Please verify your email first');
      }

      console.log('‚úÖ Login successful for user:', userId);
      return {
        success: true,
        userId,
        username: userData.username,
        email: userData.email,
        tier: userData.tier || 'free'
      };
    } catch (error) {
      console.error('Login error:', error);
      throw error;
    }
  }

  async sendOTP(email) {
    this.currentOTP = this.generateOTP();
    this.currentEmail = email;

    try {
      console.log('üìß Attempting to send OTP to:', email);
      
      // Prepare email parameters - FIXED TEMPLATE ID
      const templateParams = {
        to_email: email,
        otp_code: this.currentOTP,
        app_name: 'YANZ Hub',
        from_name: 'YANZ Verification',
        expiry_minutes: 5
      };

      console.log('üìß Using template params:', templateParams);

      // Send email using EmailJS - FIXED TEMPLATE ID
      const response = await emailjs.send(
        'service_wxwtcsh',           // Service ID
        'template_80ptwc6',          // FIXED: Correct Template ID
        templateParams,
        'QRpj9mdUY5jURnFt7'         // Public Key
      );

      console.log('‚úÖ Email sent successfully:', response.status);
      console.log('üìß OTP sent:', this.currentOTP);
      
      // Also store in Firebase for backup
      if (database) {
        const otpRef = database.ref(`otps/${email.replace(/[^a-z0-9]/gi, '_')}`);
        await otpRef.set({
          otp: this.currentOTP,
          email: email,
          createdAt: Date.now(),
          expiresAt: Date.now() + 5 * 60 * 1000
        });
        console.log('‚úÖ OTP saved to Firebase');
      }
      
      return { 
        success: true, 
        message: 'Verification code sent to your email'
      };

    } catch (emailError) {
      console.error('‚ùå EmailJS failed:', emailError);
      
      // Fallback to Firebase only
      if (database) {
        try {
          const otpRef = database.ref(`otps/${email.replace(/[^a-z0-9]/gi, '_')}`);
          await otpRef.set({
            otp: this.currentOTP,
            email: email,
            createdAt: Date.now(),
            expiresAt: Date.now() + 5 * 60 * 1000
          });
          
          console.log('‚úÖ OTP saved to Firebase as fallback');
          console.log('üìß OTP for debugging:', this.currentOTP);
          
          return { 
            success: true, 
            message: 'Verification code generated. Please check Firebase console for OTP.',
            otp: this.currentOTP // For debugging
          };
        } catch (error) {
          console.error('‚ùå Failed to store OTP in Firebase:', error);
        }
      }
      
      throw new Error('Failed to send verification. Please try again later.');
    }
  }
}

      async verifyOTP(email, otp) {
        // First check memory OTP
        if (otp === this.currentOTP && email === this.currentEmail) {
          // Update user verification status
          if (database) {
            const snapshot = await database.ref('users').once('value');
            snapshot.forEach((child) => {
              const user = child.val();
              if (user.email && user.email.toLowerCase() === email.toLowerCase()) {
                database.ref(`users/${child.key}/verified`).set(true);
                return { success: true, userId: child.key };
              }
            });
          }
          return { success: true, userId: 'temp_' + Date.now() };
        }

        // Check Firebase OTP
        if (database) {
          try {
            const otpRef = database.ref(`otps/${email.replace(/[^a-z0-9]/gi, '_')}`);
            const snapshot = await otpRef.once('value');
            
            if (snapshot.exists()) {
              const otpData = snapshot.val();
              
              // Check expiration
              if (Date.now() > otpData.expiresAt) {
                await otpRef.remove();
                throw new Error('OTP expired');
              }

              // Verify OTP
              if (otpData.otp === otp) {
                await otpRef.remove();
                
                // Find and verify user
                const userSnapshot = await database.ref('users').once('value');
                let userId = null;
                
                userSnapshot.forEach((child) => {
                  const user = child.val();
                  if (user.email && user.email.toLowerCase() === email.toLowerCase()) {
                    userId = child.key;
                  }
                });

                if (userId) {
                  await database.ref(`users/${userId}/verified`).set(true);
                  return { success: true, userId };
                }
              }
            }
          } catch (error) {
            console.error('Firebase OTP verification error:', error);
          }
        }

        throw new Error('Invalid OTP code');
      }

      createSession(userData) {
        const sessionId = 'session_' + Date.now();
        const session = {
          sessionId,
          userId: userData.userId,
          username: userData.username,
          email: userData.email,
          tier: userData.tier || 'free',
          createdAt: Date.now(),
          expiresAt: Date.now() + (24 * 60 * 60 * 1000)
        };

        // Store in localStorage
        localStorage.setItem('yanz_session', JSON.stringify(session));
        localStorage.setItem('yanz_user', JSON.stringify(userData));

        // Store in Firebase if available
        if (database) {
          database.ref(`sessions/${sessionId}`).set({
            ...session,
            userAgent: navigator.userAgent
          }).catch(error => console.error('Session save error:', error));
        }

        this.currentUser = userData;
        return session;
      }

      logout() {
        localStorage.removeItem('yanz_session');
        localStorage.removeItem('yanz_user');
        this.currentUser = null;
      }
    }

    function initializeApp() {
      authSystem = new AuthSystem();
      updateCaptcha();
      setupEventListeners();
      checkExistingSession();
      
      console.log('‚úÖ App initialized successfully');
    }

    function updateCaptcha() {
      if (authSystem && document.getElementById('captcha-text')) {
        document.getElementById('captcha-text').textContent = authSystem.currentCaptcha;
      }
    }

    function setupEventListeners() {
      // Navigation
      document.getElementById('goto-register').addEventListener('click', showRegister);
      document.getElementById('goto-login').addEventListener('click', showLogin);
      
      // Forms
      document.getElementById('login-form').addEventListener('submit', handleLogin);
      document.getElementById('register-form').addEventListener('submit', handleRegister);
      
      // OTP
      document.getElementById('verify-otp').addEventListener('click', verifyOTP);
      document.getElementById('resend-otp').addEventListener('click', resendOTP);
      
      // Password visibility
      document.getElementById('toggle-login-password').addEventListener('click', () => 
        togglePassword('login-password', 'toggle-login-password'));
      document.getElementById('toggle-register-password').addEventListener('click', () => 
        togglePassword('register-password', 'toggle-register-password'));
      document.getElementById('toggle-confirm-password').addEventListener('click', () => 
        togglePassword('confirm-password', 'toggle-confirm-password'));
      
      // CAPTCHA refresh
      document.getElementById('refresh-captcha').addEventListener('click', () => {
        if (authSystem) {
          authSystem.currentCaptcha = authSystem.generateCaptcha();
          updateCaptcha();
          document.getElementById('captcha-input').value = '';
        }
      });
      
      // Terms modal
      document.getElementById('show-terms').addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('terms-modal').classList.add('active');
      });
      document.getElementById('close-terms').addEventListener('click', () => {
        document.getElementById('terms-modal').classList.remove('active');
      });
      
      // Notification close
      document.getElementById('notification-close').addEventListener('click', hideNotification);
      
      // Password strength
      document.getElementById('register-password').addEventListener('input', checkPasswordStrength);
      document.getElementById('confirm-password').addEventListener('input', checkPasswordMatch);
      
      // OTP inputs
      document.querySelectorAll('.otp-input').forEach((input, index) => {
        input.addEventListener('input', (e) => handleOTPInput(e, index));
        input.addEventListener('keydown', (e) => handleOTPKeydown(e, index));
      });
      
      // Auto-hide notification
      setInterval(() => {
        const notification = document.getElementById('notification');
        if (notification.classList.contains('show')) {
          hideNotification();
        }
      }, 5000);
    }

    function showRegister() {
      document.getElementById('login-card').style.display = 'none';
      document.getElementById('register-card').style.display = 'block';
      resetErrors('login');
    }

    function showLogin() {
      document.getElementById('register-card').style.display = 'none';
      document.getElementById('otp-card').style.display = 'none';
      document.getElementById('login-card').style.display = 'block';
      resetErrors('register');
      resetErrors('otp');
    }

    function showOTP(email) {
      document.getElementById('register-card').style.display = 'none';
      document.getElementById('otp-card').style.display = 'block';
      
      // Clear OTP inputs
      document.querySelectorAll('.otp-input').forEach(input => input.value = '');
      document.querySelector('.otp-input').focus();
      
      startOTPTimer(300);
      startResendTimer(60);
    }

    async function handleLogin(e) {
      e.preventDefault();
      
      resetErrors('login');
      
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;
      const captcha = document.getElementById('captcha-input').value.trim();
      
      let isValid = true;
      
      // Validate email
      if (!email) {
        showError('login-email', 'Email is required');
        isValid = false;
      } else if (!isValidEmail(email)) {
        showError('login-email', 'Please enter a valid email');
        isValid = false;
      }
      
      // Validate password
      if (!password) {
        showError('login-password', 'Password is required');
        isValid = false;
      }
      
      // Validate CAPTCHA
      if (!captcha) {
        showError('captcha', 'CAPTCHA is required');
        isValid = false;
      } else if (captcha !== authSystem.currentCaptcha) {
        showError('captcha', 'Incorrect CAPTCHA');
        authSystem.currentCaptcha = authSystem.generateCaptcha();
        updateCaptcha();
        isValid = false;
      }
      
      if (!isValid) return;
      
      const submitBtn = document.getElementById('login-submit');
      const originalText = submitBtn.innerHTML;
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing In...';
      
      try {
        const result = await authSystem.loginUser(email, password);
        
        if (result.success) {
          authSystem.createSession(result);
          
          showNotification('Login successful! Redirecting...', 'success');
          
          setTimeout(() => {
            window.location.href = 'https://lphisv5.github.io/v4/Main.html';
          }, 1500);
        }
      } catch (error) {
        showError('login-password', error.message);
        authSystem.currentCaptcha = authSystem.generateCaptcha();
        updateCaptcha();
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
      }
    }

    async function handleRegister(e) {
      e.preventDefault();
      
      resetErrors('register');
      
      const username = document.getElementById('register-username').value.trim();
      const email = document.getElementById('register-email').value.trim();
      const password = document.getElementById('register-password').value;
      const confirmPassword = document.getElementById('confirm-password').value;
      const termsAgreed = document.getElementById('terms-agree').checked;
      
      let isValid = true;
      
      // Validate username
      if (!username) {
        showError('username', 'Username is required');
        isValid = false;
      } else if (username.length < 3) {
        showError('username', 'Username must be at least 3 characters');
        isValid = false;
      } else if (username.length > 20) {
        showError('username', 'Username must be less than 20 characters');
        isValid = false;
      }
      
      // Validate email
      if (!email) {
        showError('email', 'Email is required');
        isValid = false;
      } else if (!isValidEmail(email)) {
        showError('email', 'Please enter a valid email');
        isValid = false;
      }
      
      // Validate password
      if (!password) {
        showError('password', 'Password is required');
        isValid = false;
      } else if (!isStrongPassword(password)) {
        showError('password', 'Password must be at least 8 characters with uppercase, lowercase, and number');
        isValid = false;
      }
      
      // Validate confirm password
      if (!confirmPassword) {
        showError('confirm-password', 'Please confirm your password');
        isValid = false;
      } else if (password !== confirmPassword) {
        showError('confirm-password', 'Passwords do not match');
        isValid = false;
      }
      
      // Validate terms
      if (!termsAgreed) {
        showError('terms', 'You must agree to the terms and conditions');
        isValid = false;
      }
      
      if (!isValid) return;
      
      const submitBtn = document.getElementById('register-submit');
      const originalText = submitBtn.innerHTML;
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Account...';
      
      try {
        const userData = { username, email, password };
        const result = await authSystem.registerUser(userData);
        
        if (result.success) {
          const otpResult = await authSystem.sendOTP(email);
          
          showNotification(otpResult.message, 'info');
          showOTP(email);
        }
      } catch (error) {
        showError('email', error.message);
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
      }
    }

    async function verifyOTP() {
      const otpInputs = document.querySelectorAll('.otp-input');
      const otp = Array.from(otpInputs).map(input => input.value).join('');
      
      if (otp.length !== 6) {
        showError('otp', 'Please enter the complete 6-digit code');
        return;
      }
      
      const verifyBtn = document.getElementById('verify-otp');
      const originalText = verifyBtn.innerHTML;
      verifyBtn.disabled = true;
      verifyBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Verifying...';
      
      try {
        const result = await authSystem.verifyOTP(authSystem.currentEmail, otp);
        
        if (result.success) {
          const email = authSystem.currentEmail;
          const username = document.getElementById('register-username').value;
          
          const sessionData = {
            userId: result.userId,
            username,
            email,
            tier: 'free'
          };
          
          authSystem.createSession(sessionData);
          
          showNotification('Account verified successfully! Redirecting...', 'success');
          
          setTimeout(() => {
            window.location.href = 'https://lphisv5.github.io/v4/Main.html';
          }, 1500);
        }
      } catch (error) {
        showError('otp', error.message);
        otpInputs.forEach(input => input.value = '');
        otpInputs[0].focus();
      } finally {
        verifyBtn.disabled = false;
        verifyBtn.innerHTML = originalText;
      }
    }

    async function resendOTP() {
      const resendBtn = document.getElementById('resend-otp');
      if (resendBtn.disabled) return;
      
      const originalText = resendBtn.innerHTML;
      resendBtn.disabled = true;
      resendBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Resending...';
      
      try {
        const result = await authSystem.sendOTP(authSystem.currentEmail);
        showNotification(result.message, 'info');
        startResendTimer(60);
      } catch (error) {
        showNotification('Failed to resend OTP: ' + error.message, 'error');
      } finally {
        resendBtn.disabled = false;
        resendBtn.innerHTML = originalText;
      }
    }

    function checkExistingSession() {
      const session = localStorage.getItem('yanz_session');
      if (session) {
        try {
          const sessionData = JSON.parse(session);
          if (Date.now() < sessionData.expiresAt) {
            setTimeout(() => {
              window.location.href = 'https://lphisv5.github.io/v4/Main.html';
            }, 1000);
          } else {
            // Session expired
            localStorage.removeItem('yanz_session');
            localStorage.removeItem('yanz_user');
          }
        } catch (error) {
          localStorage.removeItem('yanz_session');
          localStorage.removeItem('yanz_user');
        }
      }
    }

    function isValidEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    function isStrongPassword(password) {
      const requirements = {
        length: password.length >= 8,
        uppercase: /[A-Z]/.test(password),
        lowercase: /[a-z]/.test(password),
        number: /\d/.test(password)
      };
      
      return Object.values(requirements).filter(Boolean).length >= 3;
    }

    function checkPasswordStrength() {
      const password = document.getElementById('register-password').value;
      const strengthBar = document.getElementById('password-strength-bar');
      const requirements = document.querySelectorAll('.requirement');
      
      const checks = {
        length: password.length >= 8,
        uppercase: /[A-Z]/.test(password),
        lowercase: /[a-z]/.test(password),
        number: /\d/.test(password),
        special: /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)
      };
      
      requirements.forEach(req => {
        const type = req.id.replace('req-', '');
        if (checks[type]) {
          req.classList.add('valid');
          req.classList.remove('invalid');
          req.innerHTML = `<i class="fas fa-check-circle"></i> ${req.textContent.replace('‚óè', '').trim()}`;
        } else {
          req.classList.remove('valid');
          req.classList.add('invalid');
          req.innerHTML = `<i class="fas fa-circle"></i> ${req.textContent.replace('‚úì', '').trim()}`;
        }
      });
      
      const strength = Object.values(checks).filter(Boolean).length;
      const percent = (strength / 5) * 100;
      
      strengthBar.style.width = `${percent}%`;
      strengthBar.className = 'password-strength-bar';
      
      if (percent <= 20) strengthBar.classList.add('strength-weak');
      else if (percent <= 40) strengthBar.classList.add('strength-fair');
      else if (percent <= 60) strengthBar.classList.add('strength-good');
      else strengthBar.classList.add('strength-strong');
    }

    function checkPasswordMatch() {
      const password = document.getElementById('register-password').value;
      const confirm = document.getElementById('confirm-password').value;
      
      if (!confirm) {
        hideError('confirm-password');
        return;
      }
      
      if (password !== confirm) {
        showError('confirm-password', 'Passwords do not match');
      } else {
        hideError('confirm-password');
      }
    }

    function togglePassword(passwordId, toggleId) {
      const passwordInput = document.getElementById(passwordId);
      const toggleIcon = document.getElementById(toggleId);
      
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.className = 'fas fa-eye-slash input-icon';
      } else {
        passwordInput.type = 'password';
        toggleIcon.className = 'fas fa-eye input-icon';
      }
    }

    function handleOTPInput(e, index) {
      const input = e.target;
      const value = input.value;
      
      // Only allow numbers
      if (!/^\d?$/.test(value)) {
        input.value = '';
        return;
      }
      
      // Auto-focus next input
      if (value && index < 5) {
        document.querySelector(`.otp-input[data-index="${index + 1}"]`).focus();
      }
      
      // Auto-submit when all fields are filled
      if (index === 5 && value) {
        const allFilled = Array.from(document.querySelectorAll('.otp-input'))
          .every(input => input.value);
        if (allFilled) {
          setTimeout(verifyOTP, 100);
        }
      }
    }

    function handleOTPKeydown(e, index) {
      // Move to previous input on backspace
      if (e.key === 'Backspace' && !e.target.value && index > 0) {
        document.querySelector(`.otp-input[data-index="${index - 1}"]`).focus();
      }
    }

    function startOTPTimer(duration) {
      let timeLeft = duration;
      const timerElement = document.getElementById('otp-timer');
      
      // Clear existing timer
      if (authSystem.otpTimer) clearInterval(authSystem.otpTimer);
      
      authSystem.otpTimer = setInterval(() => {
        timeLeft--;
        
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        
        if (timeLeft <= 0) {
          clearInterval(authSystem.otpTimer);
          showError('otp', 'Verification code has expired');
          document.getElementById('verify-otp').disabled = true;
        }
      }, 1000);
    }

    function startResendTimer(duration) {
      let timeLeft = duration;
      const resendBtn = document.getElementById('resend-otp');
      const timerElement = document.getElementById('resend-timer');
      
      resendBtn.disabled = true;
      
      // Clear existing timer
      if (authSystem.resendTimer) clearInterval(authSystem.resendTimer);
      
      authSystem.resendTimer = setInterval(() => {
        timeLeft--;
        timerElement.textContent = timeLeft;
        
        if (timeLeft <= 0) {
          clearInterval(authSystem.resendTimer);
          resendBtn.disabled = false;
          resendBtn.innerHTML = '<i class="fas fa-redo"></i> Resend Code';
          timerElement.textContent = '';
        }
      }, 1000);
    }

    function showError(field, message) {
      const errorElement = document.getElementById(`${field}-error`);
      if (errorElement) {
        errorElement.textContent = message;
        errorElement.classList.add('show');
        
        const input = document.getElementById(field);
        if (input) input.classList.add('error');
      }
    }

    function hideError(field) {
      const errorElement = document.getElementById(`${field}-error`);
      if (errorElement) {
        errorElement.classList.remove('show');
        
        const input = document.getElementById(field);
        if (input) input.classList.remove('error');
      }
    }

    function resetErrors(form) {
      if (form === 'login') {
        hideError('login-email');
        hideError('login-password');
        hideError('captcha');
      } else if (form === 'register') {
        hideError('username');
        hideError('email');
        hideError('password');
        hideError('confirm-password');
        hideError('terms');
      } else if (form === 'otp') {
        hideError('otp');
      }
    }

    function showNotification(message, type = 'info') {
      const notification = document.getElementById('notification');
      const messageElement = document.getElementById('notification-message');
      
      messageElement.textContent = message;
      notification.className = `notification show`;
      
      // Set color based on type
      if (type === 'success') {
        notification.style.borderLeftColor = '#81c784';
      } else if (type === 'error') {
        notification.style.borderLeftColor = '#e57373';
      } else if (type === 'warning') {
        notification.style.borderLeftColor = '#ffb74d';
      } else {
        notification.style.borderLeftColor = '#4fc3f7';
      }
    }

    function hideNotification() {
      document.getElementById('notification').classList.remove('show');
    }
  </script>
</body>
</html>
